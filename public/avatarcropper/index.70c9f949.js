var e,t,n,i,a,r,o,l,d,s,c,h,u,p,m,f,v,g,w,y,b,x,C,L,E,k,B,I,R,F="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},M={},P={},T=F.parcelRequired274;function A(e,t){var n=Object.create(e.prototype);return n.className=t,n}function S(e,t){Object.defineProperty(e.prototype,t,{get:function(){return this.element[t]},set:function(e){this.element[t]=e}})}function D(e,t){Object.defineProperty(e.prototype,t,{get:function(){return this.element.style[t]},set:function(e){this.element.style[t]=e}})}function O(){this.element||(this.element=document.createElement("div")),this.body||(this.body=this.element),this.element.classList.add("pbfe"+(this.className?this.className:"Widget"))}function U(e){e||(e=document.createElement("div"),document.body.appendChild(e)),this.element=e,O.call(this)}function H(e){var t=document.createElement("div");t.style.display="flex",t.style.flexDirection=e,this.element=t,O.call(this)}function W(){var e=document.createElement("div");e.style.position="fixed",this.element=e,O.call(this)}function G(e){var t=document.createElement("span");t.innerText=e,this.element=t,O.call(this)}function j(e,t,n){var i=document.createElement(!0===n?"a":"button");e&&(i.innerText=e),t&&i.classList.add(t),this.element=i,O.call(this)}function z(e){var t=document.createElement("div");t.style.zIndex=101;var n=document.createElement("div");n.classList.add("pbfeDialogTitle"),n.innerText=e,t.appendChild(n);var i=document.createElement("div");i.classList.add("pbfeDialogBody"),t.appendChild(i);var a=document.createElement("div");a.classList.add("pbfeDialogButtons"),a.style.display="flex",t.appendChild(a),this.element=t,this.title=n,this.body=i,this.buttons=a,O.call(this)}function Y(e){var t,n,i;"checkbox"===e?((n=document.createElement("button")).classList.add("pbfeCheckbox"),(i=document.createElement("div")).classList.add("pbfeCheckboxInner"),n.appendChild(i),Object.defineProperty(n,"checked",{get:function(){return this._checked},set:function(e){this._checked!=e&&(this._checked=e,e?n.classList.add("checked"):n.classList.remove("checked"),n.dispatchEvent(new Event("change")))}}),n._checked=!1,n.addEventListener("click",function(){this.checked=!this.checked}),t=n):(t=document.createElement("input")).type=e,this.element=t,this.type=e,O.call(this)}function N(){var e=document.createElement("div"),t=document.createElement("div");t.classList.add("pbfeProgressBarInner"),t.style.width="0%",t.style.height="100%",e.appendChild(t),this.element=e,this.inner=t,O.call(this)}function K(){this.element=document.createElement("canvas"),O.call(this)}function X(e){var t=document.createElement("div");t.style.zIndex=102,t.innerText=e,this.element=t,O.call(this)}function V(){var e=document.createElement("select");this.element=e,O.call(this)}null==T&&((T=function(e){if(e in M)return M[e].exports;if(e in P){var t=P[e];delete P[e];var n={id:e,exports:{}};return M[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){P[e]=t},F.parcelRequired274=T),T.register,O.prototype.appendChild=function(e){this.body.appendChild(e.element)},O.prototype.appendChildren=function(e){for(var t=0;t<e.length;++t)this.appendChild(e[t])},O.prototype.removeChild=function(e){this.body.removeChild(e.element)},O.prototype.removeChildAfterTransition=function(e,t){var n=this.body;this.element.addEventListener("transitionend",function i(){n.removeChild(e.element),t&&t(),this.removeEventListener("transitionend",i)})},O.prototype.addEventListener=function(e,t){this.element.addEventListener.apply(this.element,arguments)},O.prototype.contains=function(e){return e.element.parentNode==this.element},D(O,"width"),D(O,"height"),D(O,"order"),D(O,"flexGrow"),D(O,"flexShrink"),D(O,"flexBasis"),D(O,"alignSelf"),U.prototype=A(O,"Container"),U.prototype.createShadow=function(){if(!document.getElementById("pbfeShadow")){var e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;z-index:100;",e.id="pbfeShadow",this.element.appendChild(e)}},U.prototype.showToast=function(e,t,n){var i=new X(e);this.appendChild(i),setTimeout(i.show.bind(i),0);var a=this;setTimeout(function(){n?(i.element.addEventListener("transitionend",function e(){a.removeChild(i),i.element.removeEventListener("transitionend",e)}),i.hide()):this.removeChild(i)},t)},H.prototype=A(O,"Flexbox"),D(H,"flexDirection"),D(H,"justifyContent"),D(H,"alignItems"),D(H,"alignContent"),D(H,"gap"),D(H,"rowGap"),D(H,"columnGap"),W.prototype=A(O,"Floatbox"),D(W,"zIndex"),D(W,"top"),D(W,"left"),D(W,"bottom"),D(W,"right"),G.prototype=A(O,"Label"),Object.defineProperty(G.prototype,"text",{get:function(){return this.element.innerText},set:function(e){this.element.innerText=e}}),j.prototype=A(G,"Button"),S(j,"href"),S(j,"target"),z.prototype=A(O,"Dialog"),z.prototype.show=function(){this.element.classList.add("show");var e=document.getElementById("pbfeShadow");e&&e.classList.add("show")},z.prototype.hide=function(){if(this.element.classList.contains("show")){this.element.classList.remove("show");var e=document.getElementById("pbfeShadow");e&&e.classList.remove("show")}},z.prototype.appendButton=function(e){this.buttons.appendChild(e.element)},z.prototype.removeButton=function(e){this.buttons.removeChild(e.element)},z.prototype.appendHideButton=function(e,t){var n=new j(e,t);n.addEventListener("click",this.hide.bind(this)),this.appendButton(n)},Object.defineProperty(z.prototype,"titleText",{get:function(){return this._title.innerText},set:function(e){this._title.innerText=e}}),Y.prototype=A(O,"Input"),S(Y,"value"),S(Y,"placeholder"),S(Y,"min"),S(Y,"max"),S(Y,"step"),N.prototype=A(O,"ProgressBar"),N.prototype.setProgress=function(e){var t=this.inner;if("number"==typeof e){if(e<0){t.style.removeProperty("width"),t.classList.add("indeterminate");return}e=100*e+"%"}t.classList.contains("indeterminate")&&t.classList.remove("indeterminate"),t.style.width=e},K.prototype=A(O,"Canvas"),K.prototype.getContext=function(){return this.element.getContext.apply(this.element,arguments)},X.prototype=A(G,"Toast"),X.prototype.show=function(){this.element.classList.add("show")},X.prototype.hide=function(){this.element.classList.remove("show")},V.prototype=A(O,"Selector"),V.prototype.addOption=function(e,t,n){var i=document.createElement("option");i.text=e,t&&(i.value=t),n&&(i.hidden=i.disabled=i.selected=!0),this.element.appendChild(i)},S(V,"value");var Z={Container:U,Widget:O,Flexbox:H,Floatbox:W,Label:G,Button:j,Dialog:z,Input:Y,ProgressBar:N,Selector:V},q={},Q={};function J(e){return e in q?q[e]:e}var $={init:async function(){var e=await fetch("./i18n/langs.json");Q=await e.json()},loadLanguage:async function(e){if(!(e in Q))throw Error();var t=await fetch("./i18n/"+e+".json");q=await t.json()},getLanguages:function(){return Q}},ee={init:function(e){eU=new Z.Dialog(J("Loading...")),e.appendChild(eU),(eH=new Z.ProgressBar).element.id="loadingBar",eU.appendChild(eH)},show:function(){eU.show()},hide:function(){eU.hide()},setProgress:function(e){eH.setProgress(e)}},et={init:function(e){eW=e},show:function(e){eW.showToast(e,3e3,!0)}};function en(e,t,n,i){for(var a=e[t++],r=1<<a,o=r+1,l=o+1,d=a+1,s=(1<<d)-1,c=0,h=0,u=0,p=e[t++],m=new Int32Array(4096),f=null;;){for(;c<16&&0!==p;)h|=e[t++]<<c,c+=8,1===p?p=e[t++]:--p;if(c<d)break;var v=h&s;if(h>>=d,c-=d,v===r){l=o+1,s=(1<<(d=a+1))-1,f=null;continue}if(v===o)break;for(var g=v<l?v:f,w=0,y=g;y>r;)y=m[y]>>8,++w;var b=y;if(u+w+(g!==v?1:0)>i){console.log("Warning, gif stream longer than expected.");return}n[u++]=b;var x=u+=w;for(g!==v&&(n[u++]=b),y=g;w--;)y=m[y],n[--x]=255&y,y>>=8;null!==f&&l<4096&&(m[l++]=f<<8|b,l>=s+1&&d<12&&(++d,s=s<<1|1)),f=v}return u!==i&&console.log("Warning, gif stream shorter than expected."),n}try{e_=function(e,t,n,i){var a=0,i=void 0===i?{}:i,r=void 0===i.loop?null:i.loop,o=void 0===i.palette?null:i.palette;if(t<=0||n<=0||t>65535||n>65535)throw Error("Width/Height invalid.");function l(e){var t=e.length;if(t<2||t>256||t&t-1)throw Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return t}e[a++]=71,e[a++]=73,e[a++]=70,e[a++]=56,e[a++]=57,e[a++]=97;var d=0,s=0;if(null!==o){for(var c=l(o);c>>=1;)++d;if(c=1<<d,--d,void 0!==i.background){if((s=i.background)>=c)throw Error("Background index out of range.");if(0===s)throw Error("Background index explicitly passed as 0.")}}if(e[a++]=255&t,e[a++]=t>>8&255,e[a++]=255&n,e[a++]=n>>8&255,e[a++]=(null!==o?128:0)|d,e[a++]=s,e[a++]=0,null!==o)for(var h=0,u=o.length;h<u;++h){var p=o[h];e[a++]=p>>16&255,e[a++]=p>>8&255,e[a++]=255&p}if(null!==r){if(r<0||r>65535)throw Error("Loop count invalid.");e[a++]=33,e[a++]=255,e[a++]=11,e[a++]=78,e[a++]=69,e[a++]=84,e[a++]=83,e[a++]=67,e[a++]=65,e[a++]=80,e[a++]=69,e[a++]=50,e[a++]=46,e[a++]=48,e[a++]=3,e[a++]=1,e[a++]=255&r,e[a++]=r>>8&255,e[a++]=0}var m=!1;this.addFrame=function(t,n,i,r,d,s){if(!0===m&&(--a,m=!1),s=void 0===s?{}:s,t<0||n<0||t>65535||n>65535)throw Error("x/y invalid.");if(i<=0||r<=0||i>65535||r>65535)throw Error("Width/Height invalid.");if(d.length<i*r)throw Error("Not enough pixels for the frame size.");var c=!0,h=s.palette;if(null==h&&(c=!1,h=o),null==h)throw Error("Must supply either a local or global palette.");for(var u=l(h),p=0;u>>=1;)++p;u=1<<p;var f=void 0===s.delay?0:s.delay,v=void 0===s.disposal?0:s.disposal;if(v<0||v>3)throw Error("Disposal out of range.");var g=!1,w=0;if(void 0!==s.transparent&&null!==s.transparent&&(g=!0,(w=s.transparent)<0||w>=u))throw Error("Transparent color index.");if((0!==v||g||0!==f)&&(e[a++]=33,e[a++]=249,e[a++]=4,e[a++]=v<<2|(!0===g?1:0),e[a++]=255&f,e[a++]=f>>8&255,e[a++]=w,e[a++]=0),e[a++]=44,e[a++]=255&t,e[a++]=t>>8&255,e[a++]=255&n,e[a++]=n>>8&255,e[a++]=255&i,e[a++]=i>>8&255,e[a++]=255&r,e[a++]=r>>8&255,e[a++]=!0===c?128|p-1:0,!0===c)for(var y=0,b=h.length;y<b;++y){var x=h[y];e[a++]=x>>16&255,e[a++]=x>>8&255,e[a++]=255&x}return a=function(e,t,n,i){e[t++]=n;var a=t++,r=1<<n,o=r-1,l=r+1,d=l+1,s=n+1,c=0,h=0;function u(n){for(;c>=n;)e[t++]=255&h,h>>=8,c-=8,t===a+256&&(e[a]=255,a=t++)}function p(e){h|=e<<c,c+=s,u(8)}var m=i[0]&o,f={};p(r);for(var v=1,g=i.length;v<g;++v){var w=i[v]&o,y=m<<8|w,b=f[y];if(void 0===b){for(h|=m<<c,c+=s;c>=8;)e[t++]=255&h,h>>=8,c-=8,t===a+256&&(e[a]=255,a=t++);4096===d?(p(r),d=l+1,s=n+1,f={}):(d>=1<<s&&++s,f[y]=d++),m=w}else m=b}return p(m),p(l),u(1),a+1===t?e[a]=0:(e[a]=t-a-1,e[t++]=0),t}(e,a,p<2?2:p,d)},this.end=function(){return!1===m&&(e[a++]=59,m=!0),a},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(t){e=t},this.getOutputBufferPosition=function(){return a},this.setOutputBufferPosition=function(e){a=e}},eG=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||(e[t++]+1&253)!=56||97!==e[t++])throw Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,a=e[t++],r=1<<(7&a)+1;e[t++],e[t++];var o=null,l=null;a>>7&&(o=t,l=r,t+=3*r);var d=!0,s=[],c=0,h=null,u=0,p=null;for(this.width=n,this.height=i;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){var m=e[t++];if(!(m>=0))throw Error("Invalid block size");if(0===m)break;t+=m}break;case 249:if(4!==e[t++]||0!==e[t+4])throw Error("Invalid graphics extension block.");var f=e[t++];c=e[t++]|e[t++]<<8,h=e[t++],(1&f)==0&&(h=null),u=f>>2&7,t++;break;case 1:case 254:for(;;){var m=e[t++];if(!(m>=0))throw Error("Invalid block size");if(0===m)break;t+=m}break;default:throw Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var v=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++],x=b>>7,C=b>>6&1,L=1<<(7&b)+1,E=o,k=l,B=!1;if(x){var B=!0;E=t,k=L,t+=3*L}var I=t;for(t++;;){var m=e[t++];if(!(m>=0))throw Error("Invalid block size");if(0===m)break;t+=m}s.push({x:v,y:g,width:w,height:y,has_local_palette:B,palette_offset:E,palette_size:k,data_offset:I,data_length:t-I,transparent_index:h,interlaced:!!C,delay:c,disposal:u});break;case 59:d=!1;break;default:throw Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return s.length},this.loopCount=function(){return p},this.frameInfo=function(e){if(e<0||e>=s.length)throw Error("Frame index out of range.");return s[e]},this.decodeAndBlitFrameBGRA=function(t,i){var a=this.frameInfo(t),r=a.width*a.height,o=new Uint8Array(r);en(e,a.data_offset,o,r);var l=a.palette_offset,d=a.transparent_index;null===d&&(d=256);var s=a.width,c=n-s,h=s,u=(a.y*n+a.x)*4,p=((a.y+a.height)*n+a.x)*4,m=u,f=4*c;!0===a.interlaced&&(f+=28*n);for(var v=8,g=0,w=o.length;g<w;++g){var y=o[g];if(0===h&&(m+=f,h=s,m>=p&&(f=4*c+4*n*(v-1),m=u+(s+c)*(v<<1),v>>=1)),y===d)m+=4;else{var b=e[l+3*y],x=e[l+3*y+1],C=e[l+3*y+2];i[m++]=C,i[m++]=x,i[m++]=b,i[m++]=255}--h}},this.decodeAndBlitFrameRGBA=function(t,i){var a=this.frameInfo(t),r=a.width*a.height,o=new Uint8Array(r);en(e,a.data_offset,o,r);var l=a.palette_offset,d=a.transparent_index;null===d&&(d=256);var s=a.width,c=n-s,h=s,u=(a.y*n+a.x)*4,p=((a.y+a.height)*n+a.x)*4,m=u,f=4*c;!0===a.interlaced&&(f+=28*n);for(var v=8,g=0,w=o.length;g<w;++g){var y=o[g];if(0===h&&(m+=f,h=s,m>=p&&(f=4*c+4*n*(v-1),m=u+(s+c)*(v<<1),v>>=1)),y===d)m+=4;else{var b=e[l+3*y],x=e[l+3*y+1],C=e[l+3*y+2];i[m++]=b,i[m++]=x,i[m++]=C,i[m++]=255}--h}}}}catch(e){}var ei=[];function ea(e,t,n){this.buffer=[],this.writer=new e_(this.buffer,e,t,n)}ea.prototype.addFrame=function(e,t){let n=void 0!=t.delay?t.delay:0,i=void 0!=t.disposal?t.disposal:2,a=t.keepColors,r=void 0!=t.x?t.x:0,o=void 0!=t.y?t.y:0,l=e.width,d=e.height,s=[],c=[],h=function(e,t,n,i){var a=null;for(let o=0;o<e.length;o+=4){let l=e[o],d=e[o+1],s=e[o+2];if(0==e[o+3]){if(null==a){if(t.length<256)a=t.push(0)-1;else{n.push(0);continue}}n.push(a);continue}let c=((255&l)<<16)+((255&d)<<8)+(255&s),h,u=null;for(let e=1;e<t.length;++e){let n=t[e];if(n==c){h=e,u=null;break}if(!i||256==t.length){let t=Math.abs(l-(n>>16&255))+Math.abs(d-(n>>8&255))+Math.abs(s-(255&n));(null==u||t<u)&&(h=e,u=t)}}var r=15+40*Math.pow(2,10*(t.length/256)-10);256!=t.length&&u>r&&(h=null),h||(h=t.push(c)-1),n.push(h)}if(256==t.length)return a;let o=t.length;o<2?o=2:(--o,o|=o>>1,o|=o>>2,o|=o>>4,++o);let l=o-t.length;for(let e=0;e<l;++e)t.push(0);return a}(e.data,s,c,a);this.writer.addFrame(r,o,l,d,c,{palette:s,delay:n,transparent:h,disposal:i})},ea.prototype.end=function(){this.writer.end()},ea.prototype.getUint8Array=function(){return Uint8Array.from(this.buffer)};var er={Renderer:ea,load:function(e,t){var n=new FileReader;n.onloadend=async function(){if(n.error){toast.show(_("Failed to load GIF frames."));return}var e,i,a,r,o=new Uint8Array(n.result);try{e=new eG(o)}catch(e){toast.show(_("Failed to load GIF frames: ")+e.message);return}var{width:l,height:d}=e;t.loopCount.value=e.loopCount();for(let t=0;t<e.numFrames();++t){let n,o;let s=e.frameInfo(t);r?r=!1:3==s.disposal?n=i:0!=s.disposal&&t>0&&(n=a),o=n?new ImageData(new Uint8ClampedArray(n),l,d):new ImageData(l,d),e.decodeAndBlitFrameRGBA(t,o.data),a=o.data,0==s.disposal?i=o.data:2==s.disposal&&(r=!0);let c=await createImageBitmap(o);ei[t]={info:s,bitmap:c}}var s=e.numFrames()-1;t.frame.min=0,t.frame.max=s,t.frame.value=0,t.frame.disabled=!1,t.endFrame.value=s,t.keepGifColors.checked=!0},n.readAsArrayBuffer(e)},reset:function(){return!!ei.length&&(er.frames=ei=[],!0)},isAnimated:function(){return ei.length>1},frames:ei};function eo(e){let t=!1;return function(){t||(t=!0,window.requestAnimationFrame(function(){e(),t=!1}))}}var el=null;function ed(e){var t,n=e.changedTouches;if(null!=el){for(let e=0;e<n.length;++e)if(n[e].identifier==el){t=n[e];break}}var i="";switch(e.type){case"touchstart":if(null!=el||0==n.length)return;i="mousedown",el=(t=n[0]).identifier;break;case"touchmove":i="mousemove";break;case"touchend":t&&(el=null),i="mouseup";break;default:return}if(t){var a=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:!1,altKey:!1,metaKey:!1,button:0,relatedTarget:null});this.dispatchEvent(a)}}function es(){}function ec(e,t){var n=document.createElement("datalist");n.id=e;for(let e=0;e<t.length;++e){let i=document.createElement("option");i.value=t[e],n.appendChild(i)}return document.body.appendChild(n),e}function eh(e,t,n){return e>=n.x&&t>=n.y&&e<=n.x+n.width&&t<=n.y+n.height}function eu(e,t){return Math.hypot(e.pageX-t.pageX,e.pageY-t.pageY)}function ep(e,t,n,i,a){e.moveTo(t,n),e.lineTo(i,a)}es.prototype.create=function(e,t,n,i){t||(t=e);var a,r=new Z.Label(t);return r.element.classList.add("menuInputBox"),i&&r.element.classList.add("split"),"color"==n?(a=new Z.Widget).element.classList.add("cpButton"):(a=new Z.Input(n)).element.setAttribute("aria-label",t),r.appendChild(a),this[e]=a.element,r};var em=!1,ef={hsl:{maxValues:[360,100,100,255],toCss:eO,toHex:function(e,t,n){return eA(...eP(e,t,n))},convFunc:function(e,t,n){let i=Math.max(e/=255,t/=255,n/=255),a=i-Math.min(e,t,n),r=a?i===e?(t-n)/a:i===t?2+(n-e)/a:4+(e-t)/a:0;return[60*r<0?60*r+360:60*r,100*(a?i<=.5?a/(2*i-a):a/(2-(2*i-a)):0),100*(2*i-a)/2]}},rgb:{maxValues:[255,255,255,255],toCss:eD,toHex:eA,convFunc:eP}},ev={};function eg(e){var t=new Z.Flexbox;t.element.classList.add("valueFlex");var n=new Z.Label(e);t.appendChild(n);var i=new Z.Widget;i.element.classList.add("slider"),t.appendChild(i);var a=new Z.Widget;a.element.classList.add("sliderPoint"),i.appendChild(a);var r=new Z.Input("number");return r.element.min=r.value=0,t.appendChild(r),eV.push({label:n,slider:i,point:a,input:r,num:eV.length}),t}function ew(e,t){e.value=Math.round(t),e.element.dataset.value=t}function ey(e){return+e.element.dataset.value}function eb(e){if(eZ!=e){var t=eZ;eZ=e;for(var[n,i,a,r]=eV,{maxValues:o,convFunc:l}=ef[e],d=0;d<eV.length;++d){var s=eV[d];s.input.element.max=o[d],d<eZ.length&&(s.label.text=eZ[d].toUpperCase())}"hsl"==eZ?(ex(n.slider,[eO(0,100,50,1),eO(60,100,50,1),eO(120,100,50,1),eO(180,100,50,1),eO(240,100,50,1),eO(300,100,50,1),eO(360,100,50,1)]),eY.element.classList.add("chosen"),eN.element.classList.remove("chosen")):"rgb"==eZ&&(ex(n.slider,["#000000","#ff0000"]),ex(i.slider,["#000000","#00ff00"]),ex(a.slider,["#000000","#0000ff"]),eN.element.classList.add("chosen"),eY.element.classList.remove("chosen")),t&&eC(...l(ey(n.input),ey(i.input),ey(a.input)),ey(r.input))}}function ex(e,t){e.element.style.backgroundImage="linear-gradient(90deg,"+t.join(",")+")"}function eC(e,t,n,i){if("hsl"==eZ){var[a,r,o]=eV;ex(r.slider,[eO(e,0,n,1),eO(e,100,n,1)]),ex(o.slider,["#000000",eO(e,t,50,1),"#ffffff"])}for(var{maxValues:l,toCss:d,toHex:s}=ef[eZ],c=0;c<eV.length;++c){var h=eV[c];ew(h.input,arguments[c]),h.point.element.style.left=arguments[c]/l[c]*100+"%"}eK.value=s(e,t,n),eq&&(eq.style.backgroundColor=d(e,t,n,i/255),eq.dispatchEvent(new Event("colorchange")))}function eL(){for(var e=[],t=0;t<eV.length;++t)e.push(eV[t].input.value);eC(...e)}function eE(e){eJ=this,ek(e)}function ek(e){if(eJ){e.preventDefault();var t=eJ,n=t.slider.element.getBoundingClientRect(),i=Math.max(n.left,Math.min(e.clientX,n.right))-n.left,a=ef[eZ].maxValues[t.num];ew(t.input,Math.round(i/n.width*a)),eL()}}function eB(e){eJ=null}ev=T("l35ZM").getBundleURL("6gEBg")+"eye-dropper.e70ddc8f.svg";var eI=!1;function eR(){ej.contains(ez)&&!eI&&(ez.element.classList.add("hide"),eI=!0,ej.removeChildAfterTransition(ez,function(){eI=!1}),eq=null,eQ&&(eF(!1),eQ=null))}function eF(e){eQ&&((em=e)?(eX.element.classList.add("active"),eQ.addEventListener("eyedrop",eM)):(eX.element.classList.remove("active"),eQ.removeEventListener("eyedrop",eM)),eQ.dispatchEvent(new CustomEvent("edstatechange",{detail:em})))}function eM(e){em&&(eb(e.detail.mode),eC(...e.detail.color),eF(!1))}function eP(e,t,n){let i=t=>(t+e/30)%12,a=(t/=100)*Math.min(n/=100,1-n),r=e=>n-a*Math.max(-1,Math.min(i(e)-3,Math.min(9-i(e),1)));return[255*r(0),255*r(8),255*r(4)]}function eT(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function eA(e,t,n){return e=Math.floor(e),t=Math.floor(t),n=Math.floor(n),eT(e)+eT(t)+eT(n)}function eS(e){return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function eD(e,t,n,i){return"rgba("+e+","+t+","+n+","+i+")"}function eO(e,t,n,i){return"hsla("+e+","+t+"%,"+n+"%,"+i+")"}var eU,eH,eW,e_,eG,ej,ez,eY,eN,eK,eX,eV,eZ,eq,eQ,eJ,e$,e0={init:function(e){ej=e,(ez=new Z.Floatbox).element.classList.add("hide"),ez.element.id="colorPicker";var t=new Z.Flexbox;t.flexDirection="column",t.gap="0.25rem",ez.appendChild(t);var n=new Z.Flexbox;n.element.style.marginBottom="0.5rem",t.appendChild(n),(eY=new Z.Button("HSL")).element.classList.add("modeBtn"),n.appendChild(eY),(eN=new Z.Button("RGB")).element.classList.add("modeBtn"),n.appendChild(eN),eV=[],t.appendChildren([eg("H"),eg("S"),eg("L"),eg("A")]);var i=new Z.Flexbox;i.justifyContent="center",i.alignItems="center",i.gap="0.5rem",t.appendChild(i);var a=new Z.Label("Hex");i.appendChild(a),(eK=new Z.Input("text")).placeholder="ffffff",eK.element.style.fontFamily="monospace",i.appendChild(eK),(eX=new Z.Button).element.classList.add("edButton");var r=document.createElement("img");r.src=new URL(ev),r.width=r.height=16,eX.element.appendChild(r),i.appendChild(eX);var o=new Z.Button(J("Close"));o.element.style.marginTop="0.5rem",t.appendChild(o),eY.addEventListener("click",eb.bind(null,"hsl")),eN.addEventListener("click",eb.bind(null,"rgb"));for(var l=0;l<eV.length;++l){var d=eV[l];d.input.addEventListener("input",function(){ew(d.input,d.input.value),eL()});var s=d.slider;s.addEventListener("mousedown",eE.bind(d)),document.addEventListener("mousemove",ek),document.addEventListener("mouseup",eB),s.addEventListener("touchstart",ed,{passive:!0})}var c=/^#?[0-9A-F]{6}$/i,h=eV[3];eK.addEventListener("input",function(){var e=this.value;if(c.test(e)){"#"==e[0]&&(e=e.slice(1));var[t,n,i]=eS(e);eb("rgb"),eC(t,n,i,ey(eV[3].input))}}),eX.addEventListener("click",function(){eF(!em)}),o.addEventListener("click",eR),ex(h.slider,[eD(255,255,255,0),eD(255,255,255,1)]),eZ=null},show:function(e,t){if(ej.contains(ez)||(ej.appendChild(ez),setTimeout(function(){ez.element.classList.remove("hide")},0)),e){if(eq!=e){eq=e;var n=e.style.backgroundColor;if(n.startsWith("rgb")||"#"==n[0]){eb("rgb");var[i,a,r,o]="#"==n[0]?eS(n.slice(1)):n.replace(/(rgba?\(|\))| /g,"").split(",");eC(i,a,r,void 0===o?255:o)}else if(n.startsWith("hsl")){eb("hsl");var[l,d,s,o]=n.replace(/(hsla?\(|\))| /g,"").split(",");eC(l,d,s,void 0===o?255:o)}var c=e.getBoundingClientRect(),h=ez.element,u=h.getBoundingClientRect(),p=Math.max(0,Math.min(c.top-u.height-6,window.innerHeight-u.height)),m=Math.max(0,Math.min(c.right-u.width,window.innerWidth-u.width));h.style.top=p+"px",h.style.left=m+"px",t&&(eQ=t)}}else eq=null,eb("hsl"),eC(0,100,100,255)},hide:eR,isEyeDropperActive:function(){return em}},e1=new es,e5=document.createElement("canvas"),e2=e5.getContext("2d"),e8={brightness:{name:"Brightness",min:0,max:200,unit:"%"},contrast:{name:"Contrast",min:0,max:200,unit:"%"},"hue-rotate":{name:"Hue",min:0,max:360,unit:"deg"},saturate:{name:"Saturation",min:0,max:200,unit:"%"},grayscale:{name:"Grayscale",min:0,max:100,unit:"%"},sepia:{name:"Sepia",min:0,max:100,unit:"%"},invert:{name:"Invert",min:0,max:100,unit:"%"},opacity:{name:"Opacity",min:0,max:100,unit:"%"},blur:{name:"Blur",min:0,max:100,unit:"px"}},e6={brightness:100,contrast:100,"hue-rotate":0,saturate:100,grayscale:0,sepia:0,invert:0,opacity:100,blur:0},e3=eo(function(){e2.clearRect(0,0,e5.width,e5.height),e2.filter=e4(td),e2.drawImage(to,0,0)});function e4(e){var t="";for(let i in e)if(e[i]!=e6[i]){var n=e8[i].unit;t+=i+"("+e[i]+n+")"}return""==t&&(t="none"),t}var e7=function(e){(e$=new Z.Dialog(J("Filters"))).element.style.textAlign="center",e$.element.style.minWidth="min(22rem, 86%)",e.appendChild(e$),e5.style.marginTop="0",e5.style.marginBottom="0.5rem",e$.body.appendChild(e5);var t=ec("filterDetent0",[0]),n=ec("filterDetent100",[100]),i=[];for(let e in e8){var a=e8[e],r=e1.create(e,J(a.name),"range"),o=e1[e];o.min=a.min,o.max=a.max;var l=e6[e];0==l?o.setAttribute("list",t):100==l&&o.setAttribute("list",n),o.addEventListener("input",function(){td[e]=this.value,e3()}),i.push(r)}var d=new Z.Widget;d.element.id="filtersInputsBox",d.appendChildren(i),e$.appendChild(d);var s=new Z.Button(J("Reset"),"secondary");s.element.style.marginRight="auto",e$.appendButton(s);var c=new Z.Button(J("OK"));e$.appendButton(c),c.addEventListener("click",function(){e$.hide(),tl&&tl()}),s.addEventListener("click",function(){for(let e in td)e1[e].value=e6[e],delete td[e];e3()})},e9=function(e,t,n){for(let t in e?td=e:(e=e6,td={}),e8)e1[t].value=t in e?e[t]:e6[t];to=t,tl=n,e5.width=to.width,e5.height=to.height,e3(),e$.show()},te={discord:new URL(T("l35ZM").getBundleURL("6gEBg")+"discord.a4af9988.html")},tt={};async function tn(){for(var e=th.contentDocument.getElementsByClassName("avatar"),t={},n=0;n<e.length;++n){var i=e[n],a=i.dataset.size,r=t[a];r||(t[a]=r=await tr(a)),i.src=r,await function(e){return new Promise(t=>{e.addEventListener("load",t,{once:!0})})}(i),i.draggable=!1}for(var n in t)URL.revokeObjectURL(t[n])}tt=T("l35ZM").getBundleURL("6gEBg")+"loading.f836516e.svg";var ti=document.createElement("canvas"),ta=ti.getContext("2d");async function tr(e){ti.width=ti.height=e,ta.imageSmoothingQuality="high",ta.drawImage(tp,0,0,tp.width,tp.height,0,0,e,e);var t=await new Promise(e=>ti.toBlob(e));return URL.createObjectURL(t)}var to,tl,td,ts,tc,th,tu,tp,tm,tf,tv,tg,tw,ty,tb,tx,tC,tL,tE=function(e){(ts=new Z.Dialog(J("Web Preview"))).element.id="webPreviewDialog",ts.body.innerText=J("Select a website:"),e.appendChild(ts);var t=new Z.Button(J("Close"));ts.appendButton(t),(tc=new Z.Selector).addOption("----","placeholder",!0),tc.addOption("Discord","discord"),tc.element.style.marginLeft="0.5rem",ts.appendChild(tc);var n=new Z.Widget;n.element.id="previewIFrameWrapper",ts.appendChild(n),(th=document.createElement("iframe")).id="previewIFrame",th.title=J("Web Preview"),n.body.appendChild(th),(tu=new Z.Widget).element.id="loadNotif",n.appendChild(tu);var i=document.createElement("img");i.id="loadSpinner",i.src=new URL(tt),i.width=i.height=128,i.alt="Loading",tu.body.appendChild(i);var a=new Z.Label(J("Loading..."));tu.appendChild(a),t.addEventListener("click",function(){ts.hide(),tm()}),tc.addEventListener("change",function(){var e,t;e=this.value,(t=tu.element).classList.add("show"),th.src=te[e],th.addEventListener("load",async function(){th.contentDocument?await tn():et.show(J("Failed to load preview page.")),t.classList.remove("show")},{once:!0})})},tk=function(e,t){tp=e,tm=t,tc.value="placeholder",th.src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+PGh0bWw+PGJvZHkgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6IzI1MjcyOTsiPjwvYm9keT48L2h0bWw+",ts.show()},tB=new es,tI=document.createElement("a"),tR={CIRCLE:1,SQUARE:2,FREEFORM:3},tF=tR.CIRCLE,tM=[128,64,32],tP={};function tT(){s.src||(s.src="./demo.mp4",s.play()),d.show()}function tA(e,t){var n=tO(e);n&&!(n<10)&&(tF!=tR.FREEFORM?(tB.width.value=tB.height.value=n,t4.width=t4.height=n):t4[t]=n,t0(t4.width,t4.height),t9(),tB.showPreview.checked&&no())}function tS(e,t){var n=tO(e);void 0!==n&&(t4[t]=n,t$(t4.x,t4.y),t9(),tB.showPreview.checked&&no())}function tD(e){var t=new Z.Label(e);return t.element.classList.add("sectionTitle"),t}function tO(e){if(""!=e.value){var t=Number(e.value);if(isNaN(t)){t_(J("Invalid value"));return}return t}}function tU(e,t,n){var i=new Z.Button(e),a=["menuBtn"];return t&&a.push("split"),n&&a.push("chosen"),i.element.classList.add(...a),i}function tH(e,t,n){var i,r,o=tU(e,!1,n),l=((i=document.createElement("span")).classList.add("shapeIcon",t),i);return o.element.prepend(l),o.addEventListener("click",(r=tR[t.toUpperCase()],function(){if(tF!=r){tF=r,r!=tR.FREEFORM&&t0(t4.width,t4.width);for(let e=0;e<a.length;++e)a[e].parentNode.style.borderRadius=(r==tR.CIRCLE?tM[e]:0)+"px";this.classList.add("chosen"),c.classList.remove("chosen"),c=this,t9(),tB.showPreview.checked&&no()}})),o}tP=T("l35ZM").getBundleURL("6gEBg")+"demo-thumbnail.ee15827b.jpg";var tW=null;function t_(t,n){null!=tW&&clearTimeout(tW),n||(n=1e3);var i=e.element;i.innerText=t,i.classList.add("show"),tW=setTimeout(function(){i.classList.remove("show"),tW=null},n)}function tG(){h={},o.show()}function tj(){u.checked=tB.cropToShape.checked,nd(),r.show()}function tz(){if(y){var e=er.isAnimated()?er.frames[0].bitmap:b;p.width=e.width,p.height=e.height,m.drawImage(e,0,0),y=!1}l.show()}function tY(e,i){var a=e.width,r=e.height,o=Math.abs(Math.sin(i)),l=Math.abs(Math.cos(i)),d=Math.ceil(a*l+r*o),s=Math.ceil(a*o+r*l);return t.width=d,t.height=s,n.translate(d/2,s/2),n.rotate(i),n.drawImage(e,-a/2,-r/2),createImageBitmap(n.getImageData(0,0,d,s))}async function tN(e){if(0!=e&&360!=e){if(e=e*Math.PI/180,er.isAnimated()){w||(w=er.frames);for(var t=[],n=0;n<w.length;++n){var{info:i,bitmap:a}=w[n],r=await tY(a,e);t[n]={info:i,bitmap:r}}er.frames=t}else g||(g=b),b=await tY(g,e)}else if(g)b=g,g=null;else{if(!w)return;er.frames=w,w=null}if(er.isAnimated()){var o=tB.frame.value;b=er.frames[o].bitmap}tK(b.width,b.height),t7=!0,tV(),tQ()}function tK(e,t){tx.width=ty.width=na.width=e,tx.height=ty.height=na.height=t}var tX=!1;function tV(){tf.appendChild(tv),setTimeout(function(){tv.element.classList.remove("hide")},0),localStorage.getItem("tutorialShown")||(tT(),localStorage.setItem("tutorialShown","true"))}function tZ(){tv.element.classList.add("hide"),tf.removeChildAfterTransition(tv),e0.hide(),tB.playGif.checked=!1}function tq(){return tv.element.classList.contains("hide")}function tQ(){var e;tJ(),e=Math.floor((b.width<b.height?b.width:b.height)*.5),e-=e%10,t4.x=t4.y=0,t0(e,e),t$(0,0),tB.flipH.checked=tB.flipV.checked=!1,t9(),nl()}function tJ(){var e=tg.element,t=e.offsetWidth,n=e.offsetHeight,i=b.width/b.height,a=tB.scaleDevicePixel.checked?1:devicePixelRatio;t6((t/n>i?n/b.height:t/b.width)*a),t2(0,0)}function t$(e,t){tB.allowOffscreen.checked||(e=Math.max(0,Math.min(e,b.width-t4.width)),t=Math.max(0,Math.min(t,b.height-t4.height))),t4.x=e,t4.y=t,tB.xPos.value=e,tB.yPos.value=t}function t0(e,t,n){tB.allowOffscreen.checked||(e=Math.min(e,b.width-t4.x),t=Math.min(t,b.height-t4.y));var i=b.width<50||b.height<50?1:10;e=Math.max(i,e),t=Math.max(i,t),tF!=tR.FREEFORM&&((n?e>t:e<t)?t=e:e=t),t4.width=e,t4.height=t,tB.width.value=e,tB.height.value=t}var t1=0,t5=0;function t2(e,t){t1=e,t5=t;var n=tw.element;n.style.marginLeft=t1+"px",n.style.marginTop=t5+"px"}var t8=1;function t6(e){var t=tB.scaleDevicePixel.checked?1:devicePixelRatio,n=(e=Math.round(1e3*Math.max(.1,Math.min(e,8)))/1e3)/t,i=b.width*n+"px",a=b.height*n+"px",r=tw.element.style;r.width=r.minWidth=i,r.height=r.minHeight=a,tB.zoom.value=Math.round(100*e);var o=Math.ceil(Math.max(1,1/(n*devicePixelRatio)));o!=tb.lineWidth&&(tb.lineWidth=o,t9());var l=e/t8;t2(t1*l,t5*l),t8=e,t_(J("Zoom: ")+ +(100*e).toFixed(1)+"%")}function t3(e,t){var n=tB.flipH.checked,i=tB.flipV.checked,a=1,r=1;n&&(t.translate(e.width,0),a=-1),i&&(t.translate(0,e.height),r=-1),t.scale(a,r)}var t4={x:0,y:0,width:0,height:0},t7=!1,t9=eo(function(){var e,t,n,i=tb;i.globalCompositeOperation="source-over",t7?(e=[0,0,ty.width,ty.height],t7=!1):(e=C,i.clearRect(...e)),i.fillStyle="rgba(0,0,0,0.5)",i.fillRect(...e);var a=i.lineWidth,r=t4.x-a/2,o=t4.y-a/2,l=t4.width+a,d=t4.height+a;if(i.strokeStyle="#ffffff",tF==tR.CIRCLE?(i.strokeRect(r,o,l,d),t=t4.x+t4.width/2,n=t4.y+t4.height/2,i.beginPath(),i.arc(t,n,l/2-a/2,0,2*Math.PI)):(i.beginPath(),i.rect(r,o,l,d)),i.save(),i.stroke(),i.restore(),i.globalCompositeOperation="destination-out",i.fillStyle="#000000",i.fill(),tB.showGuidelines.checked){i.globalCompositeOperation="source-over",i.setLineDash([10,10]),i.strokeStyle=tB.guideColor.style.backgroundColor,i.lineWidth+=1+Math.floor(t4.width*t4.height/1e6),void 0===t&&(t=t4.x+t4.width/2,n=t4.y+t4.height/2);var s=t4.x+t4.width,c=t4.y+t4.height;i.beginPath(),ep(i,t,n,t,t4.y),ep(i,t,n,t4.x,n),ep(i,t,n,t,c),ep(i,t,n,s,n),i.stroke(),i.setLineDash([]),i.lineWidth=a}C=[t4.x-a,t4.y-a,t4.width+2*a,t4.height+2*a]}),ne=eo(function(){var e=tC;e.clearRect(0,0,b.width,b.height),e.fillStyle=tB.bgColor.style.backgroundColor,e.fillRect(0,0,b.width,b.height),t3(tx,e),e.drawImage(b,0,0,b.width,b.height),e.resetTransform()}),nt=!1,nn=!1;async function ni(){if(nt){nn=!0;return}nt=!0;var e,t,n=tB.flipH.checked,i=tB.flipV.checked;if(er.isAnimated()||n||i||!(b instanceof Image)){var r=await (nr.clearRect(0,0,b.width,b.height),t3(na,nr),nr.drawImage(b,0,0,b.width,b.height),nr.resetTransform(),new Promise(e=>na.toBlob(e)));e=URL.createObjectURL(r),t=!0}else e=b.src;let o=0;for(let n=0;n<a.length;++n){var l=a[n];l.addEventListener("load",function(){++o==a.length&&(nt=!1,t&&URL.revokeObjectURL(e),nn&&(nn=!1,ni()))},{once:!0}),l.src=e}}var na=document.createElement("canvas"),nr=na.getContext("2d");function no(){for(let i=0;i<a.length;++i){let r=a[i];var e=tM[i],t=e/t4.width,n=e/t4.height;r.style.left=-t4.x*t+"px",r.style.top=-t4.y*n+"px",r.style.width=b.width*t+"px",r.style.height=b.height*n+"px"}}function nl(){ne(),tB.showPreview.checked&&(ni(),no())}function nd(e,n){e||(e=t);let i=e.getContext("2d");if(e.width=t4.width,e.height=t4.height,i.fillStyle=tB.bgColor.style.backgroundColor,i.fillRect(0,0,e.width,e.height),n&&(i.filter=n),!function(e,t){var n,i;let a,r;t3(e,t);let[o,l]=(n=tB.flipH.checked,i=tB.flipV.checked,a=t4.x,r=t4.y,n&&(a=b.width-t4.width-a),i&&(r=b.height-t4.height-r),[a,r]);t.drawImage(b,o,l,t4.width,t4.height,0,0,t4.width,t4.height),t.resetTransform()}(e,i),tB.cropToShape.checked&&tF==tR.CIRCLE){var a=e.width/2,r=e.height/2;i.globalCompositeOperation="destination-in",i.beginPath(),i.ellipse(a,r,a,r,0,0,2*Math.PI),i.fillStyle="#fff",i.fill(),i.globalCompositeOperation="source-over"}}function ns(e,t){tI.href=e,tI.download=t,tI.click()}function nc(){t.toBlob(function(e){var t=URL.createObjectURL(e);ns(t,x+"_cropped.png"),setTimeout(function(){URL.revokeObjectURL(t)},0)})}async function nh(){var e=new er.Renderer(t4.width,t4.height,{loop:Math.floor(tB.loopCount.value)}),i=er.frames,a=i.length?i.length-1:0,r=Math.max(0,Math.min(Math.floor(tB.startFrame.value),a)),o=Math.max(0,Math.min(Math.floor(tB.endFrame.value),a))+1,l=e4(h);ee.setProgress(0),ee.show();var d=tB.keepGifColors.checked,s=+tB.speedMult.value;for(let a=r;a<o;++a){let r=0;if(i.length){var c=i[a];b=c.bitmap,r=s?c.info.delay/s:0}nd(t,l);let h=n.getImageData(0,0,t4.width,t4.height);e.addFrame(h,{delay:r,keepColors:d}),ee.setProgress((a+1)/o)}e.end(),ee.hide(),n.filter="none";var u=new Blob([e.getUint8Array()],{type:"image/gif"}),p=URL.createObjectURL(u);ns(p,x+"_cropped.gif"),setTimeout(function(){URL.revokeObjectURL(p)},0),i.length&&(b=i[tB.frame.value].bitmap)}var nu=!1,np=!1,nm=!1,nf=!1;function nv(e){if(e0.isEyeDropperActive()){tg.element.style.cursor="default";return}var t,n=tw.element.getBoundingClientRect();if(n.x+=n.width*(t4.x/b.width),n.y+=n.height*(t4.y/b.height),n.width*=t4.width/b.width,n.height*=t4.height/b.height,(nu=eh(e.clientX,e.clientY,n))&&!nB){var i=n.x+n.width/2,a=n.y+n.height/2;(np=!(Math.pow(e.clientX-i,2)+Math.pow(e.clientY-a,2)<Math.pow(n.width/2,2)))?(nm=e.clientX<i,t=(nf=e.clientY<a)?nm?"nw-resize":"ne-resize":nm?"sw-resize":"se-resize"):t="move"}else t="grab";tg.element.style.cursor=t}var ng=!1,nw=!0;function ny(e){if(!tq()&&0==e.button){if(nw=!0,e0.isEyeDropperActive()){var t=tx.getBoundingClientRect(),n={mode:"rgb"};if(eh(e.clientX,e.clientY,t)){var i=(e.clientX-t.x)/t.width*tx.width,a=(e.clientY-t.y)/t.height*tx.height,r=tC.getImageData(i,a,1,1);n.color=r.data}else n.color=[30,30,30,255];tx.dispatchEvent(new CustomEvent("eyedrop",{detail:n}))}nv(e),nu||(tg.element.style.cursor="grabbing"),ng=!0}}function nb(){nw=!1}var nx=null,nC=null;function nL(e){if(!tq()){if(!ng){nv(e);return}if(null!=nx&&null!=nC){var t=e.clientX-nx,n=e.clientY-nC,i=tB.scaleDevicePixel.checked?1:devicePixelRatio,a=t8/i;if(e.shiftKey&&(t=a*Math.sign(t),n=a*Math.sign(n)),nu){t=Math.round(t/a),n=Math.round(n/a);var r=t4.x,o=t4.y,l=nm?-1:1,d=nf?-1:1;if(np){var s=t4.width,c=t4.height;if(tF==tR.FREEFORM)s+=t*l,c+=n*d,nm&&(r+=t)<0&&(s+=r,r=0),nf&&(o+=n)<0&&(c+=o,o=0);else{var h=Math.abs(t)>Math.abs(n)?t*l:n*d,u=h*l,p=h*d;let e=r+u,i=o+p,a=e+s+h,f=i+c+h;var m=0;!tB.allowOffscreen.checked&&(nm&&e<0&&(m=-e),nf&&i<0&&(m=-i),a>b.width&&(m=a-b.width-u),f>b.height&&(m=f-b.height-p)),m&&(h=m>h?0:h-m),s=c+=h,nm&&(r+=h*l),nf&&(o+=h*d)}nm&&s<10&&(r-=10-s),nf&&c<10&&(o-=10-c),t4.x=r,t4.y=o,t0(s,c),t$(r,o)}else t$(r+=t,o+=n);t9(),tB.showPreview.checked&&no()}else t2(t1+t,t5+n)}nx=e.clientX,nC=e.clientY}}function nE(e){tq()||0!=e.button||(nv(e),ng=!1,nx=nC=null,nu=!1)}function nk(e){if(!tq()){var t=.1;e.deltaY>0&&(t=-t),t6(t8+t)}}var nB=!1;function nI(e){ed.call(this,e),e.touches.length>=2&&(nB=!0,L=eu(e.touches[0],e.touches[1]),nu=!1)}function nR(e){if(nB){var t=eu(e.touches[0],e.touches[1]);t6(t8+(t-L)/200),L=t}}function nF(e){nB&&e.touches.length<2&&(nB=!1)}function nM(e){if(nw){if(e.code)t=e.code;else switch(e.keyCode){case 38:t="ArrowUp";break;case 40:t="ArrowDown";break;case 37:t="ArrowLeft";break;case 39:t="ArrowRight";break;default:return}var t,n=e.shiftKey?2:1;switch(t){case"ArrowUp":n=-n;case"ArrowDown":e.ctrlKey?t0(t4.width,t4.height+n,n>0):t$(t4.x,t4.y+n);break;case"ArrowLeft":n=-n;case"ArrowRight":e.ctrlKey?t0(t4.width+n,t4.height,n>0):t$(t4.x+n,t4.y);break;default:return}t9(),tB.showPreview.checked&&no()}}var nP={init:function(g){var w,y,x,C,L,E,k,B,I,R,F,M,P,T,A,S,D,O,U,H,W,G,j,z,Y,N,K,X;tf=g,(tv=new Z.Flexbox).element.id="editorBox",tv.element.classList.add("hide"),function(){(tg=new Z.Flexbox).element.id="editorInnerBox",tg.element.style.cursor="grab",tv.appendChild(tg),(tw=new Z.Widget).element.id="canvasBox",tg.appendChild(tw),(tx=document.createElement("canvas")).id="imgCanvas",tw.body.appendChild(tx),tC=tx.getContext("2d"),(ty=document.createElement("canvas")).id="editorCanvas",tw.body.appendChild(ty),(tb=ty.getContext("2d")).lineWidth=1;var e,t,n=new Z.Button("⛶");n.element.classList.add("innerBoxBtn"),n.element.title=J("Toggle fullscreen"),n.element.style.right="0",n.element.style.lineHeight="1.4",tg.appendChild(n);var r=new Z.Button("?");r.element.classList.add("innerBoxBtn"),r.element.title=J("Show tutorial"),r.element.style.right="2.5rem",r.element.style.lineHeight="1.4",tg.appendChild(r),n.addEventListener("click",function(){document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen()}),(d=new Z.Dialog(J("Tutorial"))).element.style.textAlign="center",tf.appendChild(d),e=new Z.Label(J("Drag the crop selector to move or resize it.")),d.appendChild(e),(s=document.createElement("video")).style.pointerEvents="none",s.style.width="100%",s.style.marginTop="0.5rem",s.loop=!0,s.poster=new URL(tP),d.body.appendChild(s),t=new Z.Label(J('Dragging anywhere outside of the crop selector will move the viewport. Use the mouse wheel or pinch the screen with two fingers to zoom in/out.\nOnce you\'re done, press the "Save image..." button to save your cropped image.\n\nYou may view this tutorial at any time by pressing the "?" button at the top right of the screen.')),d.appendChild(t),d.appendHideButton(J("OK")),r.addEventListener("click",tT),(i=new Z.Flexbox).element.id="previewBox",a=[];for(let e=0;e<3;++e){var o=tM[e];let t=new Z.Widget,n=t.element.style;n.width=n.height=o+"px",n.borderRadius=o/2+"px",i.appendChild(t);let r=new Image;t.element.appendChild(r),a.push(r)}tg.appendChild(i)}(),e0.init(tf),(tL=new Z.Flexbox).element.id="editorMenu",tv.appendChild(tL),w=tU(J("Save image...")),y=tU(J("Save as GIF...")),x=tU(J("Fit image to viewport")),C=tU(J("Rotate...")),(L=new Z.Widget).element.id="shapeBtnContainer",E=tH(J("Circle"),"circle",!0),k=tH(J("Square"),"square"),B=tH(J("Freeform"),"freeform"),L.appendChildren([E,k,B]),c=E.element,tL.appendChildren([tD(J("Save")),w,y,tD(J("Crop Area")),tB.create("width",J("Width"),"text",!0),tB.create("height",J("Height"),"text",!0),tB.create("xPos",J("X Pos"),"text",!0),tB.create("yPos",J("Y Pos"),"text",!0),tB.create("allowOffscreen",J("Allow offscreen"),"checkbox"),tD(J("Crop Shape")),L,tB.create("cropToShape",J("Crop to shape"),"checkbox"),tB.create("showGuidelines",J("Show guidelines"),"checkbox"),tB.create("guideColor",J("Guidelines color"),"color"),tD(J("Image")),tB.create("flipH",J("Flip horizontally"),"checkbox"),tB.create("flipV",J("Flip vertically"),"checkbox"),C,tB.create("frame",J("Frame"),"range"),tB.create("playGif",J("Play GIF"),"checkbox"),tB.create("bgColor",J("Background color"),"color"),tD(J("Viewport")),tB.create("zoom",J("Zoom"),"range"),tB.create("scaleDevicePixel",J("Scale to device pixel"),"checkbox"),x,tB.create("showPreview",J("Show preview"),"checkbox")]),tB.frame.value=0,tB.frame.disabled=!0,tB.showPreview.checked=!0,tB.bgColor.style.backgroundColor="rgba(255,255,255,0)",tB.guideColor.style.backgroundColor="rgb(255,255,0)",(I=new Z.Button(J("Open another image"),"secondary")).element.id="returnBtn",tL.appendChild(I),(R=new Z.Button(J("Hide panel"))).element.id="hideBtn",tL.appendChild(R),I.addEventListener("click",function(){tZ(),nG.show()}),F=tg.element.style,R.addEventListener("click",function(){F.width&&F.height?(F.removeProperty("width"),F.removeProperty("height"),i.element.classList.remove("panelHidden"),R.text=J("Hide panel")):(F.width="100%",F.height="100%",i.element.classList.add("panelHidden"),R.text=J("Show panel"))}),tB.width.addEventListener("input",function(){tA(this,"width")}),tB.height.addEventListener("input",function(){tA(this,"height")}),tB.xPos.addEventListener("input",function(){tS(this,"x")}),tB.yPos.addEventListener("input",function(){tS(this,"y")}),tB.showGuidelines.addEventListener("change",t9),tB.flipH.addEventListener("change",nl),tB.flipV.addEventListener("change",nl),M=ec("zoomDetents",[50,100,200,400]),(P=tB.zoom).min=10,P.max=800,P.value=t8,P.setAttribute("list",M),P.addEventListener("input",function(){t6(this.value/100)}),tB.scaleDevicePixel.addEventListener("change",function(){t6(t8)}),x.addEventListener("click",function(){tJ()}),tB.showPreview.addEventListener("change",function(e){this.checked?(i.element.style.display="flex",ni(),no()):i.element.style.display="none"}),C.addEventListener("click",tz),tB.frame.addEventListener("input",function(){if(er.isAnimated()){var e=this.value;b=er.frames[e].bitmap,nl(),t_(J("Frame: ")+e)}}),w.addEventListener("click",tj),y.addEventListener("click",tG),tB.playGif.addEventListener("change",function(){!(er.frames.length<2)&&this.checked&&function e(){if(tB.playGif.checked){var t=++tB.frame.value;t==er.frames.length&&(tB.frame.value=t=0);var n=er.frames[t];b=n.bitmap,nl(),setTimeout(e,10*n.info.delay)}}()}),tB.bgColor.addEventListener("click",function(){e0.show(this,tx)}),tB.guideColor.addEventListener("click",function(){e0.show(this,tx)}),tB.bgColor.addEventListener("colorchange",function(){ne();var e=tB.bgColor.style.backgroundColor;for(let t=0;t<a.length;++t)a[t].parentNode.style.backgroundColor=e}),tB.guideColor.addEventListener("colorchange",t9),tL.addEventListener("scroll",e0.hide,{passive:!0}),tx.addEventListener("edstatechange",function(e){e.detail?ty.style.display="none":ty.style.removeProperty("display")}),(e=new Z.Floatbox).element.id="notifBox",tv.appendChild(e),e7(tf),tE(tf),(r=new Z.Dialog(J("Save Image"))).element.id="saveDialog",tf.appendChild(r),T=new Z.Label(J("You can save the image now, or apply some filters and check how your avatar would look on some websites.")),r.appendChild(T),r.body.appendChild(document.createElement("br")),n=(t=document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),r.body.appendChild(t),(A=new Z.Flexbox).element.id="saveQuickOptionsBox",A.alignItems="center",A.justifyContent="center",r.appendChild(A),(D=(S=new Z.Input("checkbox")).element).setAttribute("aria-label",J("Crop to shape")),D.addEventListener("change",function(){tB.cropToShape.checked=D.checked,nd()}),A.appendChild(S),u=D,O=new Z.Label(J("Crop to shape")),A.appendChild(O),(U=new Z.Widget).element.id="imgActionsContainer",r.appendChild(U),H=new Z.Button("✨ "+J("Filters...")),U.appendChild(H),W=new Z.Button("\uD83D\uDDBC️ "+J("Preview...")),U.appendChild(W),G=new Z.Button(J("Save")),r.appendButton(G),j=new Z.Button(J("Close"),"secondary"),r.appendButton(j),G.addEventListener("click",nc),j.addEventListener("click",function(){r.hide()}),H.addEventListener("click",function(){r.hide(),e9(null,t,function(){n.clearRect(0,0,t4.width,t4.height),n.drawImage(e5,0,0),r.show()})}),W.addEventListener("click",function(){r.hide(),tk(t,function(){r.show()})}),(o=new Z.Dialog(J("GIF Options"))).appendChildren([tB.create("startFrame",J("Start frame"),"number"),tB.create("endFrame",J("End frame"),"number"),tB.create("loopCount",J("Loop count"),"number"),tB.create("speedMult",J("Speed multiplier"),"number"),tB.create("keepGifColors",J("Keep original colors"),"checkbox")]),(z=new Z.Label(J("Filters"))).element.classList.add("menuInputBox"),o.appendChild(z),(Y=new Z.Button("✨ "+J("Options..."))).element.style.marginLeft="auto",z.appendChild(Y),tB.startFrame.value=tB.startFrame.min=0,tB.endFrame.value=tB.endFrame.min=0,tB.loopCount.value=tB.loopCount.min=0,tB.speedMult.value=1,tB.speedMult.step=.25,tB.speedMult.min=0,tB.keepGifColors.style.paddingTop="0",N=new Z.Button(J("Save")),o.appendButton(N),N.addEventListener("click",function(){o.hide(),nh()}),Y.addEventListener("click",function(){o.hide(),nd(),e9(h,t,function(){o.show()})}),o.appendHideButton(J("Cancel"),"secondary"),tf.appendChild(o),(l=new Z.Dialog(J("Rotate"))).element.style.textAlign="center",tf.appendChild(l),(p=document.createElement("canvas")).id="rotateCanvas",m=p.getContext("2d"),l.body.appendChild(p),v=new Z.Label("0°"),l.appendChild(v),K=ec("rotateDetents",[90,180,270]),(f=new Z.Input("range")).element.style.width="100%",f.min=0,f.max=360,f.step=.1,f.value=0,f.element.setAttribute("list",K),f.element.setAttribute("aria-label",J("Rotation angle")),l.appendChild(f),X=new Z.Button(J("Apply")),l.appendButton(X),X.addEventListener("click",function(){l.hide(),tN(f.value)}),l.appendHideButton(J("Cancel"),"secondary"),f.addEventListener("input",function(){v.text=this.value+"°",p.style.transform="rotate("+this.value+"deg)"}),tg.addEventListener("mousedown",ny),tL.addEventListener("mousedown",nb),document.addEventListener("mousemove",nL),document.addEventListener("mouseup",nE),document.addEventListener("blur",nE),tg.addEventListener("wheel",nk,{passive:!0}),"ontouchstart"in document&&(tg.addEventListener("touchstart",nI,{passive:!0}),document.addEventListener("touchmove",nR,{passive:!0}),document.addEventListener("touchend",nF,{passive:!0})),document.addEventListener("keydown",nM)},open:function(e,t){var n,i;if(tX&&(URL.revokeObjectURL(g?g.src:b.src),tX=!1),g=w=null,er.reset()&&(tB.frame.value=0,tB.frame.disabled=!0,tB.startFrame.value=0,tB.endFrame.value=0,tB.loopCount.value=0,tB.keepGifColors.checked=!1,tB.playGif.checked=!1),ee.setProgress(-1),ee.show(),e instanceof File)x=e.name.slice(0,e.name.lastIndexOf(".")),"image/gif"==e.type&&er.load(e,tB),e=URL.createObjectURL(e),tX=!0;else{if(""==e)return;if(b&&e==b.src){ee.hide(),tV(),tQ(),t();return}x=e.slice(e.lastIndexOf("/")+1,e.lastIndexOf("."))}b instanceof Image||(b=new Image),b.addEventListener("load",n=function(){ee.setProgress(1),ee.hide(),tK(b.width,b.height),t7=!0,f.value=0,v.text="0°",p.style.transform="",y=!0,tV(),tQ(),t(),b.removeEventListener("load",n),b.removeEventListener("error",i)}),b.addEventListener("error",i=function(){ee.hide(),et.show(J("Failed to load image.")),b.removeEventListener("load",n),b.removeEventListener("error",i)}),b.src=e},show:tV,hide:tZ},nT={};function nA(){E.hide()}nT=T("l35ZM").getBundleURL("6gEBg")+"banner.2c50771c.svg";var nS={init:function(e){(E=new Z.Dialog(J("About"))).element.style.textAlign="center",e.appendChild(E);var t=document.createElement("img");t.src=new URL(nT),t.alt="Banner",t.width=740,t.height=128,t.style.width="auto",t.style.height="3rem",t.style.marginBottom="0.5rem",t.draggable=!0,E.body.appendChild(t),E.body.appendChild(document.createElement("br"));var n=new Z.Label(J("Simple and accurate avatar cropping tool.\n"));E.appendChild(n);var i=new Z.Label(J("Source code: "));E.appendChild(i);var a=document.createElement("a");a.href="https://github.com/LeadRDRK/AvatarCropper",a.innerText=a.href+"\n",a.target="_blank",a.draggable=!1,E.body.appendChild(a),E.body.appendChild(document.createElement("hr"));var r=document.createElement("b");r.innerText=J("Translators\n"),E.body.appendChild(r);var o=$.getLanguages();for(let e in o){var l=o[e],d=new Z.Label(l.name+" - "+l.author+"\n");E.appendChild(d)}var s=new Z.Button(J("OK"));E.appendButton(s),s.addEventListener("click",nA),t.addEventListener("dragstart",function(e){e.dataTransfer.setData("text/pain","https://leadrdrk.com/static/generic.png")}),t.addEventListener("dragend",function(e){et.show("it's him! (drawn by @ReikoRobo)"),nA()})},show:function(){E.show()},hide:nA};function nD(){k.hide()}var nO={init:function(e){k=new Z.Dialog(J("Privacy")),e.appendChild(k),k.body.innerText=J("This app runs entirely in your browser! No image or data is ever uploaded to any external server.");var t=new Z.Button(J("OK"));k.appendButton(t),t.addEventListener("click",nD)},show:function(){k.show()},hide:nD};function nU(){I.element.classList.add("hide"),R.hide(),n_.shown=!1,B.removeChildAfterTransition(I,function(){B.contains(R)&&B.removeChild(R)})}var nH=document.createElement("input");function nW(){nH.value=null,nH.click()}nH.type="file",nH.accept="image/*",nH.addEventListener("change",function(e){var t=this.files;for(let e=0;e<t.length;++e){let n=t[e];if(n.type.startsWith("image/")){nP.open(n,nU);return}}et.show(J("Invalid image file."))});var n_={shown:!1,init:function(e,t){B=e,nS.init(B),nO.init(B),(I=new Z.Flexbox("column")).element.id="welcomeScreen",I.alignItems="center";var n,i,a,r,o,l=new Z.Flexbox;l.element.id="welcomeInnerBox",l.justifyContent="center",l.alignItems="center";var d=new Z.Flexbox("column");d.element.id="titleBox",d.gap="0.25rem";var s=document.createElement("img");s.src=new URL(nT),s.width=740,s.height=128,s.id="title",s.alt="Banner",s.draggable=!1,s.onload=t,d.element.appendChild(s);var c=new Z.Label("v2.2.0 - ");c.element.id="versionLabel";var h=new Z.Button(J("About"),"link");c.appendChild(h),c.element.appendChild(document.createTextNode(" | "));var u=new Z.Button(J("Privacy"),"link");c.appendChild(u),c.element.appendChild(document.createTextNode(" | "));var p=document.createElement("a");p.innerText=J("Changelog"),p.href="https://github.com/LeadRDRK/AvatarCropper/releases",p.draggable=!1,p.target="_blank",c.element.appendChild(p),d.appendChild(c);var m=new Z.Selector;m.element.id="langSelector";var f=$.getLanguages();for(let e in f)m.addOption(f[e].name,e);m.value=localStorage.getItem("lang"),d.appendChild(m);var v=document.createElement("a");v.innerText=J("Request new features by creating an issue on GitHub!"),v.href="https://github.com/LeadRDRK/AvatarCropper/issues",v.draggable=!1,v.target="_blank",v.style.fontSize="0.9rem",v.style.marginTop="8px",v.style.textAlign="center",d.element.appendChild(v);var g=new Z.Flexbox("column");g.element.id="openButtonsBox",g.gap="0.5rem";var w=new Z.Button(J("Open File..."));g.appendChild(w);var y=new Z.Button(J("Paste Image..."),"secondary");g.appendChild(y);var b=new Z.Label(J("You can also drag and drop an image here."));b.element.style.textAlign="center",b.element.style.fontStyle="italic",b.element.style.marginTop="8px",b.element.style.fontSize="0.9rem",g.appendChild(b),l.appendChild(d),l.appendChild(g),I.appendChild(l);var x=((r=document.createElement("div")).style.marginTop="8px",(o=document.createElement("script")).id="_carbonads_js",o.src="//cdn.carbonads.com/carbon.js?serve=CW7IE2QE&placement=leadrdrkcom",r.appendChild(o),r);I.element.appendChild(x),w.addEventListener("click",nW),R=new Z.Dialog(J("Paste Image")),n=J("Paste your image into the input box."),(i=new Z.Label(n)).element.style.marginBottom="0.5rem",R.appendChild(i),(a=new Z.Input("text")).element.id="urlInput",a.element.setAttribute("aria-label",n),R.appendChild(a),R.appendHideButton(J("Cancel")),a.addEventListener("paste",function(e){var t=e.clipboardData||e.originalEvent.clipboardData;if(t){var n=t.items;for(let e=0;e<n.length;++e){let t=n[e];if("file"==t.kind){let e=t.getAsFile();if(e.type.startsWith("image/")){nP.open(e,nU);break}}}}}),a.addEventListener("input",function(){a.value=""}),B.appendChild(R),y.addEventListener("click",R.show.bind(R)),h.addEventListener("click",nS.show.bind(nS)),u.addEventListener("click",nO.show.bind(nO)),m.addEventListener("change",function(){localStorage.setItem("lang",this.value),nV()}),n_.shown=!0},show:function(){setTimeout(function(){I.element.classList.remove("hide")},0),B.appendChild(I),B.appendChild(R),n_.shown=!0},hide:nU},nG=n_;function nj(e,t){var n=new CustomEvent("imagedrop",{detail:e});t.dispatchEvent(n)}function nz(e,t){return!!e.type.startsWith("image/")&&(nj(e,t),!0)}var nY=["Hey, you should drop your file into the window.","Just drop it...","I'm getting rather impatient.","What are you doing!?","Drop it now!","Stop teasing me!","I beg you!","Please, just give me your file!!!"];function nN(e,t){this.element=t;var n=new Z.Flexbox;n.element.id="dndOverlay";var i=0,a=0;t.addEventListener("dragenter",function(){if(0==a&&(e.appendChild(n),++i>=10)){var t=nY[Math.min(i-10,nY.length-1)];et.show(t)}++a}),t.addEventListener("dragleave",function(){0==--a&&e.removeChild(n)}),t.addEventListener("drop",function(r){r.preventDefault(),i>=10+nY.length-1&&et.show("Thank you."),i=0,e.removeChild(n),a=0;var o=r.dataTransfer.getData("text/pain");if(o){nj(o,t);return}if(r.dataTransfer.items){for(let e of r.dataTransfer.items)if("file"==e.kind&&nz(e.getAsFile(),t))return}else for(let e of r.dataTransfer.files)if(nz(e,t))return;et.show(J("Invalid image file."))}),t.addEventListener("dragover",function(e){e.preventDefault()})}nN.prototype.addListener=function(e){this.element.addEventListener("imagedrop",e)};var nK={};async function nX(){"serviceWorker"in navigator&&navigator.serviceWorker.register(nK),document.body.innerHTML="";var e=new Z.Container;e.element.style.backgroundColor="#1e1e1e",e.createShadow(),et.init(e);try{await $.init();var t=function(){var e=localStorage.getItem("lang");if(null==e){var t=$.getLanguages(),n=navigator.language.toLowerCase();for(let i in t)if(0==i.indexOf(n)){e=i;break}null==e&&(e="en-us"),localStorage.setItem("lang",e)}return e}();try{await $.loadLanguage(t)}catch(e){et.show("Failed to load translations for "+t)}}catch(e){et.show("Failed to initialize i18n.")}nP.init(e),ee.init(e),ee.setProgress(-1),ee.show(),nG.init(e,function(){nG.show(),ee.hide()}),new nN(e,document.body).addListener(e=>{nP.open(e.detail,function(){nG.shown&&nG.hide()})}),"ontouchmove"in document&&(document.addEventListener("touchmove",ed,{passive:!0}),document.addEventListener("touchend",ed,{passive:!0})),window.scrollTo(0,1)}nK=T("l35ZM").getBundleURL("6gEBg")+"sw.js",nX();var nV=nX;
//# sourceMappingURL=index.70c9f949.js.map
