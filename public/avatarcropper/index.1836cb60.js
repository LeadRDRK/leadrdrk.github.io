var e,t,n,i,a,r,o,l,d,s,c,h,u,p,f,m,v,g,w,y,b,x,L,C,E,k,B,F,I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},R={},M={},P=I.parcelRequired274;function A(e,t){var n=Object.create(e.prototype);return n.className=t,n}function T(e,t){Object.defineProperty(e.prototype,t,{get:function(){return this.element[t]},set:function(e){this.element[t]=e}})}function S(e,t){Object.defineProperty(e.prototype,t,{get:function(){return this.element.style[t]},set:function(e){this.element.style[t]=e}})}function D(){this.element||(this.element=document.createElement("div")),this.body||(this.body=this.element),this.element.classList.add("pbfe"+(this.className?this.className:"Widget"))}function O(e){e||(e=document.createElement("div"),document.body.appendChild(e)),this.element=e,D.call(this)}function U(e){var t=document.createElement("div");t.style.display="flex",t.style.flexDirection=e,this.element=t,D.call(this)}function H(){var e=document.createElement("div");e.style.position="fixed",this.element=e,D.call(this)}function W(e){var t=document.createElement("span");t.innerText=e,this.element=t,D.call(this)}function G(e,t){var n=document.createElement("button");e&&(n.innerText=e),t&&n.classList.add(t),this.element=n,D.call(this)}function j(e){var t=document.createElement("div");t.style.zIndex=101;var n=document.createElement("div");n.classList.add("pbfeDialogTitle"),n.innerText=e,t.appendChild(n);var i=document.createElement("div");i.classList.add("pbfeDialogBody"),t.appendChild(i);var a=document.createElement("div");a.classList.add("pbfeDialogButtons"),a.style.display="flex",t.appendChild(a),this.element=t,this.title=n,this.body=i,this.buttons=a,D.call(this)}function z(e){var t,n,i;"checkbox"===e?((n=document.createElement("button")).classList.add("pbfeCheckbox"),(i=document.createElement("div")).classList.add("pbfeCheckboxInner"),n.appendChild(i),Object.defineProperty(n,"checked",{get:function(){return this._checked},set:function(e){this._checked!=e&&(this._checked=e,e?n.classList.add("checked"):n.classList.remove("checked"),n.dispatchEvent(new Event("change")))}}),n._checked=!1,n.addEventListener("click",function(){this.checked=!this.checked}),t=n):(t=document.createElement("input")).type=e,this.element=t,this.type=e,D.call(this)}function Y(){var e=document.createElement("div"),t=document.createElement("div");t.classList.add("pbfeProgressBarInner"),t.style.width="0%",t.style.height="100%",e.appendChild(t),this.element=e,this.inner=t,D.call(this)}function N(){this.element=document.createElement("canvas"),D.call(this)}function X(e){var t=document.createElement("div");t.style.zIndex=102,t.innerText=e,this.element=t,D.call(this)}function K(){var e=document.createElement("select");this.element=e,D.call(this)}null==P&&((P=function(e){if(e in R)return R[e].exports;if(e in M){var t=M[e];delete M[e];var n={id:e,exports:{}};return R[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){M[e]=t},I.parcelRequired274=P),P.register,D.prototype.appendChild=function(e){this.body.appendChild(e.element)},D.prototype.appendChildren=function(e){for(var t=0;t<e.length;++t)this.appendChild(e[t])},D.prototype.removeChild=function(e){this.body.removeChild(e.element)},D.prototype.removeChildAfterTransition=function(e,t){var n=this.body;this.element.addEventListener("transitionend",function i(){n.removeChild(e.element),t&&t(),this.removeEventListener("transitionend",i)})},D.prototype.addEventListener=function(e,t){this.element.addEventListener.apply(this.element,arguments)},D.prototype.contains=function(e){return e.element.parentNode==this.element},S(D,"width"),S(D,"height"),S(D,"order"),S(D,"flexGrow"),S(D,"flexShrink"),S(D,"flexBasis"),S(D,"alignSelf"),O.prototype=A(D,"Container"),O.prototype.createShadow=function(){if(!document.getElementById("pbfeShadow")){var e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;z-index:100;",e.id="pbfeShadow",this.element.appendChild(e)}},O.prototype.showToast=function(e,t,n){var i=new X(e);this.appendChild(i),setTimeout(i.show.bind(i),0);var a=this;setTimeout(function(){n?(i.element.addEventListener("transitionend",function e(){a.removeChild(i),i.element.removeEventListener("transitionend",e)}),i.hide()):this.removeChild(i)},t)},U.prototype=A(D,"Flexbox"),S(U,"flexDirection"),S(U,"justifyContent"),S(U,"alignItems"),S(U,"alignContent"),S(U,"gap"),S(U,"rowGap"),S(U,"columnGap"),H.prototype=A(D,"Floatbox"),S(H,"zIndex"),S(H,"top"),S(H,"left"),S(H,"bottom"),S(H,"right"),W.prototype=A(D,"Label"),Object.defineProperty(W.prototype,"text",{get:function(){return this.element.innerText},set:function(e){this.element.innerText=e}}),G.prototype=A(W,"Button"),j.prototype=A(D,"Dialog"),j.prototype.show=function(){this.element.classList.add("show");var e=document.getElementById("pbfeShadow");e&&e.classList.add("show")},j.prototype.hide=function(){if(this.element.classList.contains("show")){this.element.classList.remove("show");var e=document.getElementById("pbfeShadow");e&&e.classList.remove("show")}},j.prototype.appendButton=function(e){this.buttons.appendChild(e.element)},j.prototype.removeButton=function(e){this.buttons.removeChild(e.element)},j.prototype.appendHideButton=function(e,t){var n=new G(e,t);n.addEventListener("click",this.hide.bind(this)),this.appendButton(n)},Object.defineProperty(j.prototype,"titleText",{get:function(){return this._title.innerText},set:function(e){this._title.innerText=e}}),z.prototype=A(D,"Input"),T(z,"value"),T(z,"placeholder"),T(z,"min"),T(z,"max"),T(z,"step"),Y.prototype=A(D,"ProgressBar"),Y.prototype.setProgress=function(e){var t=this.inner;if("number"==typeof e){if(e<0){t.style.removeProperty("width"),t.classList.add("indeterminate");return}e=100*e+"%"}t.classList.contains("indeterminate")&&t.classList.remove("indeterminate"),t.style.width=e},N.prototype=A(D,"Canvas"),N.prototype.getContext=function(){return this.element.getContext.apply(this.element,arguments)},X.prototype=A(W,"Toast"),X.prototype.show=function(){this.element.classList.add("show")},X.prototype.hide=function(){this.element.classList.remove("show")},K.prototype=A(D,"Selector"),K.prototype.addOption=function(e,t,n){var i=document.createElement("option");i.text=e,t&&(i.value=t),n&&(i.hidden=i.disabled=i.selected=!0),this.element.appendChild(i)},T(K,"value");var V={Container:O,Widget:D,Flexbox:U,Floatbox:H,Label:W,Button:G,Dialog:j,Input:z,ProgressBar:Y,Selector:K},Z={},q={};function J(e){return e in Z?Z[e]:e}var Q={init:async function(){var e=await fetch("./i18n/langs.json");q=await e.json()},loadLanguage:async function(e){if(!(e in q))throw Error();var t=await fetch("./i18n/"+e+".json");Z=await t.json()},getLanguages:function(){return q}},$={init:function(e){eO=new V.Dialog(J("Loading...")),e.appendChild(eO),(eU=new V.ProgressBar).element.id="loadingBar",eO.appendChild(eU)},show:function(){eO.show()},hide:function(){eO.hide()},setProgress:function(e){eU.setProgress(e)}},ee={init:function(e){eH=e},show:function(e){eH.showToast(e,3e3,!0)}};function et(e,t,n,i){for(var a=e[t++],r=1<<a,o=r+1,l=o+1,d=a+1,s=(1<<d)-1,c=0,h=0,u=0,p=e[t++],f=new Int32Array(4096),m=null;;){for(;c<16&&0!==p;)h|=e[t++]<<c,c+=8,1===p?p=e[t++]:--p;if(c<d)break;var v=h&s;if(h>>=d,c-=d,v===r){l=o+1,s=(1<<(d=a+1))-1,m=null;continue}if(v===o)break;for(var g=v<l?v:m,w=0,y=g;y>r;)y=f[y]>>8,++w;var b=y;if(u+w+(g!==v?1:0)>i){console.log("Warning, gif stream longer than expected.");return}n[u++]=b;var x=u+=w;for(g!==v&&(n[u++]=b),y=g;w--;)y=f[y],n[--x]=255&y,y>>=8;null!==m&&l<4096&&(f[l++]=m<<8|b,l>=s+1&&d<12&&(++d,s=s<<1|1)),m=v}return u!==i&&console.log("Warning, gif stream shorter than expected."),n}try{eW=function(e,t,n,i){var a=0,i=void 0===i?{}:i,r=void 0===i.loop?null:i.loop,o=void 0===i.palette?null:i.palette;if(t<=0||n<=0||t>65535||n>65535)throw Error("Width/Height invalid.");function l(e){var t=e.length;if(t<2||t>256||t&t-1)throw Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return t}e[a++]=71,e[a++]=73,e[a++]=70,e[a++]=56,e[a++]=57,e[a++]=97;var d=0,s=0;if(null!==o){for(var c=l(o);c>>=1;)++d;if(c=1<<d,--d,void 0!==i.background){if((s=i.background)>=c)throw Error("Background index out of range.");if(0===s)throw Error("Background index explicitly passed as 0.")}}if(e[a++]=255&t,e[a++]=t>>8&255,e[a++]=255&n,e[a++]=n>>8&255,e[a++]=(null!==o?128:0)|d,e[a++]=s,e[a++]=0,null!==o)for(var h=0,u=o.length;h<u;++h){var p=o[h];e[a++]=p>>16&255,e[a++]=p>>8&255,e[a++]=255&p}if(null!==r){if(r<0||r>65535)throw Error("Loop count invalid.");e[a++]=33,e[a++]=255,e[a++]=11,e[a++]=78,e[a++]=69,e[a++]=84,e[a++]=83,e[a++]=67,e[a++]=65,e[a++]=80,e[a++]=69,e[a++]=50,e[a++]=46,e[a++]=48,e[a++]=3,e[a++]=1,e[a++]=255&r,e[a++]=r>>8&255,e[a++]=0}var f=!1;this.addFrame=function(t,n,i,r,d,s){if(!0===f&&(--a,f=!1),s=void 0===s?{}:s,t<0||n<0||t>65535||n>65535)throw Error("x/y invalid.");if(i<=0||r<=0||i>65535||r>65535)throw Error("Width/Height invalid.");if(d.length<i*r)throw Error("Not enough pixels for the frame size.");var c=!0,h=s.palette;if(null==h&&(c=!1,h=o),null==h)throw Error("Must supply either a local or global palette.");for(var u=l(h),p=0;u>>=1;)++p;u=1<<p;var m=void 0===s.delay?0:s.delay,v=void 0===s.disposal?0:s.disposal;if(v<0||v>3)throw Error("Disposal out of range.");var g=!1,w=0;if(void 0!==s.transparent&&null!==s.transparent&&(g=!0,(w=s.transparent)<0||w>=u))throw Error("Transparent color index.");if((0!==v||g||0!==m)&&(e[a++]=33,e[a++]=249,e[a++]=4,e[a++]=v<<2|(!0===g?1:0),e[a++]=255&m,e[a++]=m>>8&255,e[a++]=w,e[a++]=0),e[a++]=44,e[a++]=255&t,e[a++]=t>>8&255,e[a++]=255&n,e[a++]=n>>8&255,e[a++]=255&i,e[a++]=i>>8&255,e[a++]=255&r,e[a++]=r>>8&255,e[a++]=!0===c?128|p-1:0,!0===c)for(var y=0,b=h.length;y<b;++y){var x=h[y];e[a++]=x>>16&255,e[a++]=x>>8&255,e[a++]=255&x}return a=function(e,t,n,i){e[t++]=n;var a=t++,r=1<<n,o=r-1,l=r+1,d=l+1,s=n+1,c=0,h=0;function u(n){for(;c>=n;)e[t++]=255&h,h>>=8,c-=8,t===a+256&&(e[a]=255,a=t++)}function p(e){h|=e<<c,c+=s,u(8)}var f=i[0]&o,m={};p(r);for(var v=1,g=i.length;v<g;++v){var w=i[v]&o,y=f<<8|w,b=m[y];if(void 0===b){for(h|=f<<c,c+=s;c>=8;)e[t++]=255&h,h>>=8,c-=8,t===a+256&&(e[a]=255,a=t++);4096===d?(p(r),d=l+1,s=n+1,m={}):(d>=1<<s&&++s,m[y]=d++),f=w}else f=b}return p(f),p(l),u(1),a+1===t?e[a]=0:(e[a]=t-a-1,e[t++]=0),t}(e,a,p<2?2:p,d)},this.end=function(){return!1===f&&(e[a++]=59,f=!0),a},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(t){e=t},this.getOutputBufferPosition=function(){return a},this.setOutputBufferPosition=function(e){a=e}},e_=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||(e[t++]+1&253)!=56||97!==e[t++])throw Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,i=e[t++]|e[t++]<<8,a=e[t++],r=1<<(7&a)+1;e[t++],e[t++];var o=null,l=null;a>>7&&(o=t,l=r,t+=3*r);var d=!0,s=[],c=0,h=null,u=0,p=null;for(this.width=n,this.height=i;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){var f=e[t++];if(!(f>=0))throw Error("Invalid block size");if(0===f)break;t+=f}break;case 249:if(4!==e[t++]||0!==e[t+4])throw Error("Invalid graphics extension block.");var m=e[t++];c=e[t++]|e[t++]<<8,h=e[t++],(1&m)==0&&(h=null),u=m>>2&7,t++;break;case 1:case 254:for(;;){var f=e[t++];if(!(f>=0))throw Error("Invalid block size");if(0===f)break;t+=f}break;default:throw Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var v=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++],x=b>>7,L=b>>6&1,C=1<<(7&b)+1,E=o,k=l,B=!1;if(x){var B=!0;E=t,k=C,t+=3*C}var F=t;for(t++;;){var f=e[t++];if(!(f>=0))throw Error("Invalid block size");if(0===f)break;t+=f}s.push({x:v,y:g,width:w,height:y,has_local_palette:B,palette_offset:E,palette_size:k,data_offset:F,data_length:t-F,transparent_index:h,interlaced:!!L,delay:c,disposal:u});break;case 59:d=!1;break;default:throw Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return s.length},this.loopCount=function(){return p},this.frameInfo=function(e){if(e<0||e>=s.length)throw Error("Frame index out of range.");return s[e]},this.decodeAndBlitFrameBGRA=function(t,i){var a=this.frameInfo(t),r=a.width*a.height,o=new Uint8Array(r);et(e,a.data_offset,o,r);var l=a.palette_offset,d=a.transparent_index;null===d&&(d=256);var s=a.width,c=n-s,h=s,u=(a.y*n+a.x)*4,p=((a.y+a.height)*n+a.x)*4,f=u,m=4*c;!0===a.interlaced&&(m+=28*n);for(var v=8,g=0,w=o.length;g<w;++g){var y=o[g];if(0===h&&(f+=m,h=s,f>=p&&(m=4*c+4*n*(v-1),f=u+(s+c)*(v<<1),v>>=1)),y===d)f+=4;else{var b=e[l+3*y],x=e[l+3*y+1],L=e[l+3*y+2];i[f++]=L,i[f++]=x,i[f++]=b,i[f++]=255}--h}},this.decodeAndBlitFrameRGBA=function(t,i){var a=this.frameInfo(t),r=a.width*a.height,o=new Uint8Array(r);et(e,a.data_offset,o,r);var l=a.palette_offset,d=a.transparent_index;null===d&&(d=256);var s=a.width,c=n-s,h=s,u=(a.y*n+a.x)*4,p=((a.y+a.height)*n+a.x)*4,f=u,m=4*c;!0===a.interlaced&&(m+=28*n);for(var v=8,g=0,w=o.length;g<w;++g){var y=o[g];if(0===h&&(f+=m,h=s,f>=p&&(m=4*c+4*n*(v-1),f=u+(s+c)*(v<<1),v>>=1)),y===d)f+=4;else{var b=e[l+3*y],x=e[l+3*y+1],L=e[l+3*y+2];i[f++]=b,i[f++]=x,i[f++]=L,i[f++]=255}--h}}}}catch(e){}var en=[];function ei(e,t,n){this.buffer=[],this.writer=new eW(this.buffer,e,t,n)}ei.prototype.addFrame=function(e,t){let n=void 0!=t.delay?t.delay:0,i=void 0!=t.disposal?t.disposal:2,a=t.keepColors,r=void 0!=t.x?t.x:0,o=void 0!=t.y?t.y:0,l=e.width,d=e.height,s=[],c=[],h=function(e,t,n,i){var a=null;for(let o=0;o<e.length;o+=4){let l=e[o],d=e[o+1],s=e[o+2];if(0==e[o+3]){if(null==a){if(t.length<256)a=t.push(0)-1;else{n.push(0);continue}}n.push(a);continue}let c=((255&l)<<16)+((255&d)<<8)+(255&s),h,u=null;for(let e=1;e<t.length;++e){let n=t[e];if(n==c){h=e,u=null;break}if(!i||256==t.length){let t=Math.abs(l-(n>>16&255))+Math.abs(d-(n>>8&255))+Math.abs(s-(255&n));(null==u||t<u)&&(h=e,u=t)}}var r=15+40*Math.pow(2,10*(t.length/256)-10);256!=t.length&&u>r&&(h=null),h||(h=t.push(c)-1),n.push(h)}if(256==t.length)return a;let o=t.length;o<2?o=2:(--o,o|=o>>1,o|=o>>2,o|=o>>4,++o);let l=o-t.length;for(let e=0;e<l;++e)t.push(0);return a}(e.data,s,c,a);this.writer.addFrame(r,o,l,d,c,{palette:s,delay:n,transparent:h,disposal:i})},ei.prototype.end=function(){this.writer.end()},ei.prototype.getUint8Array=function(){return Uint8Array.from(this.buffer)};var ea={Renderer:ei,load:function(e,t){var n=new FileReader;n.onloadend=async function(){if(n.error){toast.show(_("Failed to load GIF frames."));return}var e,i,a,r,o=new Uint8Array(n.result);try{e=new e_(o)}catch(e){toast.show(_("Failed to load GIF frames: ")+e.message);return}var{width:l,height:d}=e;t.loopCount.value=e.loopCount();for(let t=0;t<e.numFrames();++t){let n,o;let s=e.frameInfo(t);r?r=!1:3==s.disposal?n=i:0!=s.disposal&&t>0&&(n=a),o=n?new ImageData(new Uint8ClampedArray(n),l,d):new ImageData(l,d),e.decodeAndBlitFrameRGBA(t,o.data),a=o.data,0==s.disposal?i=o.data:2==s.disposal&&(r=!0);let c=await createImageBitmap(o);en[t]={info:s,bitmap:c}}var s=e.numFrames()-1;t.frame.min=0,t.frame.max=s,t.frame.value=0,t.frame.disabled=!1,t.endFrame.value=s,t.keepGifColors.checked=!0},n.readAsArrayBuffer(e)},reset:function(){return!!en.length&&(ea.frames=en=[],!0)},isAnimated:function(){return en.length>1},frames:en};function er(e){let t=!1;return function(){t||(t=!0,window.requestAnimationFrame(function(){e(),t=!1}))}}var eo=null;function el(e){var t,n=e.changedTouches;if(null!=eo){for(let e=0;e<n.length;++e)if(n[e].identifier==eo){t=n[e];break}}var i="";switch(e.type){case"touchstart":if(null!=eo||0==n.length)return;i="mousedown",eo=(t=n[0]).identifier;break;case"touchmove":i="mousemove";break;case"touchend":t&&(eo=null),i="mouseup";break;default:return}if(t){var a=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:!1,altKey:!1,metaKey:!1,button:0,relatedTarget:null});this.dispatchEvent(a)}}function ed(){}function es(e,t){var n=document.createElement("datalist");n.id=e;for(let e=0;e<t.length;++e){let i=document.createElement("option");i.value=t[e],n.appendChild(i)}return document.body.appendChild(n),e}function ec(e,t,n){return e>=n.x&&t>=n.y&&e<=n.x+n.width&&t<=n.y+n.height}function eh(e,t){return Math.hypot(e.pageX-t.pageX,e.pageY-t.pageY)}function eu(e,t,n,i,a){e.moveTo(t,n),e.lineTo(i,a)}ed.prototype.create=function(e,t,n,i){t||(t=e);var a,r=new V.Label(t);return r.element.classList.add("menuInputBox"),i&&r.element.classList.add("split"),"color"==n?(a=new V.Widget).element.classList.add("cpButton"):(a=new V.Input(n)).element.setAttribute("aria-label",t),r.appendChild(a),this[e]=a.element,r};var ep=!1,ef={hsl:{maxValues:[360,100,100,255],toCss:eD,toHex:function(e,t,n){return eA(...eM(e,t,n))},convFunc:function(e,t,n){let i=Math.max(e/=255,t/=255,n/=255),a=i-Math.min(e,t,n),r=a?i===e?(t-n)/a:i===t?2+(n-e)/a:4+(e-t)/a:0;return[60*r<0?60*r+360:60*r,100*(a?i<=.5?a/(2*i-a):a/(2-(2*i-a)):0),100*(2*i-a)/2]}},rgb:{maxValues:[255,255,255,255],toCss:eS,toHex:eA,convFunc:eM}},em={};function ev(e){var t=new V.Flexbox;t.element.classList.add("valueFlex");var n=new V.Label(e);t.appendChild(n);var i=new V.Widget;i.element.classList.add("slider"),t.appendChild(i);var a=new V.Widget;a.element.classList.add("sliderPoint"),i.appendChild(a);var r=new V.Input("number");return r.element.min=r.value=0,t.appendChild(r),eK.push({label:n,slider:i,point:a,input:r,num:eK.length}),t}function eg(e,t){e.value=Math.round(t),e.element.dataset.value=t}function ew(e){return+e.element.dataset.value}function ey(e){if(eV!=e){var t=eV;eV=e;for(var[n,i,a,r]=eK,{maxValues:o,convFunc:l}=ef[e],d=0;d<eK.length;++d){var s=eK[d];s.input.element.max=o[d],d<eV.length&&(s.label.text=eV[d].toUpperCase())}"hsl"==eV?(eb(n.slider,[eD(0,100,50,1),eD(60,100,50,1),eD(120,100,50,1),eD(180,100,50,1),eD(240,100,50,1),eD(300,100,50,1),eD(360,100,50,1)]),ez.element.classList.add("chosen"),eY.element.classList.remove("chosen")):"rgb"==eV&&(eb(n.slider,["#000000","#ff0000"]),eb(i.slider,["#000000","#00ff00"]),eb(a.slider,["#000000","#0000ff"]),eY.element.classList.add("chosen"),ez.element.classList.remove("chosen")),t&&ex(...l(ew(n.input),ew(i.input),ew(a.input)),ew(r.input))}}function eb(e,t){e.element.style.backgroundImage="linear-gradient(90deg,"+t.join(",")+")"}function ex(e,t,n,i){if("hsl"==eV){var[a,r,o]=eK;eb(r.slider,[eD(e,0,n,1),eD(e,100,n,1)]),eb(o.slider,["#000000",eD(e,t,50,1),"#ffffff"])}for(var{maxValues:l,toCss:d,toHex:s}=ef[eV],c=0;c<eK.length;++c){var h=eK[c];eg(h.input,arguments[c]),h.point.element.style.left=arguments[c]/l[c]*100+"%"}eN.value=s(e,t,n),eZ&&(eZ.style.backgroundColor=d(e,t,n,i/255),eZ.dispatchEvent(new Event("colorchange")))}function eL(){for(var e=[],t=0;t<eK.length;++t)e.push(eK[t].input.value);ex(...e)}function eC(e){eJ=this,eE(e)}function eE(e){if(eJ){e.preventDefault();var t=eJ,n=t.slider.element.getBoundingClientRect(),i=Math.max(n.left,Math.min(e.clientX,n.right))-n.left,a=ef[eV].maxValues[t.num];eg(t.input,Math.round(i/n.width*a)),eL()}}function ek(e){eJ=null}em=P("l35ZM").getBundleURL("6gEBg")+"eye-dropper.e70ddc8f.svg";var eB=!1;function eF(){eG.contains(ej)&&!eB&&(ej.element.classList.add("hide"),eB=!0,eG.removeChildAfterTransition(ej,function(){eB=!1}),eZ=null,eq&&(eI(!1),eq=null))}function eI(e){eq&&((ep=e)?(eX.element.classList.add("active"),eq.addEventListener("eyedrop",eR)):(eX.element.classList.remove("active"),eq.removeEventListener("eyedrop",eR)),eq.dispatchEvent(new CustomEvent("edstatechange",{detail:ep})))}function eR(e){ep&&(ey(e.detail.mode),ex(...e.detail.color),eI(!1))}function eM(e,t,n){let i=t=>(t+e/30)%12,a=(t/=100)*Math.min(n/=100,1-n),r=e=>n-a*Math.max(-1,Math.min(i(e)-3,Math.min(9-i(e),1)));return[255*r(0),255*r(8),255*r(4)]}function eP(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function eA(e,t,n){return e=Math.floor(e),t=Math.floor(t),n=Math.floor(n),eP(e)+eP(t)+eP(n)}function eT(e){return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function eS(e,t,n,i){return"rgba("+e+","+t+","+n+","+i+")"}function eD(e,t,n,i){return"hsla("+e+","+t+"%,"+n+"%,"+i+")"}var eO,eU,eH,eW,e_,eG,ej,ez,eY,eN,eX,eK,eV,eZ,eq,eJ,eQ,e$={init:function(e){eG=e,(ej=new V.Floatbox).element.classList.add("hide"),ej.element.id="colorPicker";var t=new V.Flexbox;t.flexDirection="column",t.gap="0.25rem",ej.appendChild(t);var n=new V.Flexbox;n.element.style.marginBottom="0.5rem",t.appendChild(n),(ez=new V.Button("HSL")).element.classList.add("modeBtn"),n.appendChild(ez),(eY=new V.Button("RGB")).element.classList.add("modeBtn"),n.appendChild(eY),eK=[],t.appendChildren([ev("H"),ev("S"),ev("L"),ev("A")]);var i=new V.Flexbox;i.justifyContent="center",i.alignItems="center",i.gap="0.5rem",t.appendChild(i);var a=new V.Label("Hex");i.appendChild(a),(eN=new V.Input("text")).placeholder="ffffff",eN.element.style.fontFamily="monospace",i.appendChild(eN),(eX=new V.Button).element.classList.add("edButton");var r=document.createElement("img");r.src=new URL(em),r.width=r.height=16,eX.element.appendChild(r),i.appendChild(eX);var o=new V.Button(J("Close"));o.element.style.marginTop="0.5rem",t.appendChild(o),ez.addEventListener("click",ey.bind(null,"hsl")),eY.addEventListener("click",ey.bind(null,"rgb"));for(var l=0;l<eK.length;++l){var d=eK[l];d.input.addEventListener("input",function(){eg(d.input,d.input.value),eL()});var s=d.slider;s.addEventListener("mousedown",eC.bind(d)),document.addEventListener("mousemove",eE),document.addEventListener("mouseup",ek),s.addEventListener("touchstart",el,{passive:!0})}var c=/^#?[0-9A-F]{6}$/i,h=eK[3];eN.addEventListener("input",function(){var e=this.value;if(c.test(e)){"#"==e[0]&&(e=e.slice(1));var[t,n,i]=eT(e);ey("rgb"),ex(t,n,i,ew(eK[3].input))}}),eX.addEventListener("click",function(){eI(!ep)}),o.addEventListener("click",eF),eb(h.slider,[eS(255,255,255,0),eS(255,255,255,1)]),eV=null},show:function(e,t){if(eG.contains(ej)||(eG.appendChild(ej),setTimeout(function(){ej.element.classList.remove("hide")},0)),e){if(eZ!=e){eZ=e;var n=e.style.backgroundColor;if(n.startsWith("rgb")||"#"==n[0]){ey("rgb");var[i,a,r,o]="#"==n[0]?eT(n.slice(1)):n.replace(/(rgba?\(|\))| /g,"").split(",");ex(i,a,r,void 0===o?255:o)}else if(n.startsWith("hsl")){ey("hsl");var[l,d,s,o]=n.replace(/(hsla?\(|\))| /g,"").split(",");ex(l,d,s,void 0===o?255:o)}var c=e.getBoundingClientRect(),h=ej.element,u=h.getBoundingClientRect(),p=Math.max(0,Math.min(c.top-u.height-6,window.innerHeight-u.height)),f=Math.max(0,Math.min(c.right-u.width,window.innerWidth-u.width));h.style.top=p+"px",h.style.left=f+"px",t&&(eq=t)}}else eZ=null,ey("hsl"),ex(0,100,100,255)},hide:eF,isEyeDropperActive:function(){return ep}},e0=new ed,e1=document.createElement("canvas"),e5=e1.getContext("2d"),e2={brightness:{name:"Brightness",min:0,max:200,unit:"%"},contrast:{name:"Contrast",min:0,max:200,unit:"%"},"hue-rotate":{name:"Hue",min:0,max:360,unit:"deg"},saturate:{name:"Saturation",min:0,max:200,unit:"%"},grayscale:{name:"Grayscale",min:0,max:100,unit:"%"},sepia:{name:"Sepia",min:0,max:100,unit:"%"},invert:{name:"Invert",min:0,max:100,unit:"%"},opacity:{name:"Opacity",min:0,max:100,unit:"%"},blur:{name:"Blur",min:0,max:100,unit:"px"}},e6={brightness:100,contrast:100,"hue-rotate":0,saturate:100,grayscale:0,sepia:0,invert:0,opacity:100,blur:0},e3=er(function(){e5.clearRect(0,0,e1.width,e1.height),e5.filter=e8(tl),e5.drawImage(tr,0,0)});function e8(e){var t="";for(let i in e)if(e[i]!=e6[i]){var n=e2[i].unit;t+=i+"("+e[i]+n+")"}return""==t&&(t="none"),t}var e4=function(e){(eQ=new V.Dialog(J("Filters"))).element.style.textAlign="center",eQ.element.style.minWidth="min(22rem, 86%)",e.appendChild(eQ),e1.style.marginTop="0",e1.style.marginBottom="0.5rem",eQ.body.appendChild(e1);var t=es("filterDetent0",[0]),n=es("filterDetent100",[100]),i=[];for(let e in e2){var a=e2[e],r=e0.create(e,J(a.name),"range"),o=e0[e];o.min=a.min,o.max=a.max;var l=e6[e];0==l?o.setAttribute("list",t):100==l&&o.setAttribute("list",n),o.addEventListener("input",function(){tl[e]=this.value,e3()}),i.push(r)}var d=new V.Widget;d.element.id="filtersInputsBox",d.appendChildren(i),eQ.appendChild(d);var s=new V.Button(J("Reset"),"secondary");s.element.style.marginRight="auto",eQ.appendButton(s);var c=new V.Button(J("OK"));eQ.appendButton(c),c.addEventListener("click",function(){eQ.hide(),to&&to()}),s.addEventListener("click",function(){for(let e in tl)e0[e].value=e6[e],delete tl[e];e3()})},e7=function(e,t,n){for(let t in e?tl=e:(e=e6,tl={}),e2)e0[t].value=t in e?e[t]:e6[t];tr=t,to=n,e1.width=tr.width,e1.height=tr.height,e3(),eQ.show()},e9={discord:new URL(P("l35ZM").getBundleURL("6gEBg")+"discord.a4af9988.html")},te={};async function tt(){for(var e=tc.contentDocument.getElementsByClassName("avatar"),t={},n=0;n<e.length;++n){var i=e[n],a=i.dataset.size,r=t[a];r||(t[a]=r=await ta(a)),i.src=r,await function(e){return new Promise(t=>{e.addEventListener("load",t,{once:!0})})}(i),i.draggable=!1}for(var n in t)URL.revokeObjectURL(t[n])}te=P("l35ZM").getBundleURL("6gEBg")+"loading.f836516e.svg";var tn=document.createElement("canvas"),ti=tn.getContext("2d");async function ta(e){tn.width=tn.height=e,ti.imageSmoothingQuality="high",ti.drawImage(tu,0,0,tu.width,tu.height,0,0,e,e);var t=await new Promise(e=>tn.toBlob(e));return URL.createObjectURL(t)}var tr,to,tl,td,ts,tc,th,tu,tp,tf,tm,tv,tg,tw,ty,tb,tx,tL,tC=function(e){(td=new V.Dialog(J("Web Preview"))).element.id="webPreviewDialog",td.body.innerText=J("Select a website:"),e.appendChild(td);var t=new V.Button(J("Close"));td.appendButton(t),(ts=new V.Selector).addOption("----","placeholder",!0),ts.addOption("Discord","discord"),ts.element.style.marginLeft="0.5rem",td.appendChild(ts);var n=new V.Widget;n.element.id="previewIFrameWrapper",td.appendChild(n),(tc=document.createElement("iframe")).id="previewIFrame",tc.title=J("Web Preview"),n.body.appendChild(tc),(th=new V.Widget).element.id="loadNotif",n.appendChild(th);var i=document.createElement("img");i.id="loadSpinner",i.src=new URL(te),i.width=i.height=128,i.alt="Loading",th.body.appendChild(i);var a=new V.Label(J("Loading..."));th.appendChild(a),t.addEventListener("click",function(){td.hide(),tp()}),ts.addEventListener("change",function(){var e,t;e=this.value,(t=th.element).classList.add("show"),tc.src=e9[e],tc.addEventListener("load",async function(){tc.contentDocument?await tt():ee.show(J("Failed to load preview page.")),t.classList.remove("show")},{once:!0})})},tE=function(e,t){tu=e,tp=t,ts.value="placeholder",tc.src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+PGh0bWw+PGJvZHkgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6IzI1MjcyOTsiPjwvYm9keT48L2h0bWw+",td.show()},tk=new ed,tB=document.createElement("a"),tF={CIRCLE:1,SQUARE:2,FREEFORM:3},tI=tF.CIRCLE,tR=[128,64,32],tM={};function tP(){s.src||(s.src="./demo.mp4",s.play()),d.show()}function tA(e,t){var n=tD(e);n&&!(n<10)&&(tI!=tF.FREEFORM?(tk.width.value=tk.height.value=n,t8.width=t8.height=n):t8[t]=n,t$(t8.width,t8.height),t7(),tk.showPreview.checked&&nr())}function tT(e,t){var n=tD(e);void 0!==n&&(t8[t]=n,tQ(t8.x,t8.y),t7(),tk.showPreview.checked&&nr())}function tS(e){var t=new V.Label(e);return t.element.classList.add("sectionTitle"),t}function tD(e){if(""!=e.value){var t=Number(e.value);if(isNaN(t)){tW(J("Invalid value"));return}return t}}function tO(e,t,n){var i=new V.Button(e),a=["menuBtn"];return t&&a.push("split"),n&&a.push("chosen"),i.element.classList.add(...a),i}function tU(e,t,n){var i,r,o=tO(e,!1,n),l=((i=document.createElement("span")).classList.add("shapeIcon",t),i);return o.element.prepend(l),o.addEventListener("click",(r=tF[t.toUpperCase()],function(){if(tI!=r){tI=r,r!=tF.FREEFORM&&t$(t8.width,t8.width);for(let e=0;e<a.length;++e)a[e].parentNode.style.borderRadius=(r==tF.CIRCLE?tR[e]:0)+"px";this.classList.add("chosen"),c.classList.remove("chosen"),c=this,t7(),tk.showPreview.checked&&nr()}})),o}tM=P("l35ZM").getBundleURL("6gEBg")+"demo-thumbnail.ee15827b.jpg";var tH=null;function tW(t,n){null!=tH&&clearTimeout(tH),n||(n=1e3);var i=e.element;i.innerText=t,i.classList.add("show"),tH=setTimeout(function(){i.classList.remove("show"),tH=null},n)}function t_(){h={},o.show()}function tG(){nl(),r.show()}function tj(){if(w){var e=ea.isAnimated()?ea.frames[0].bitmap:y;u.width=e.width,u.height=e.height,p.drawImage(e,0,0),w=!1}l.show()}function tz(e,i){var a=e.width,r=e.height,o=Math.abs(Math.sin(i)),l=Math.abs(Math.cos(i)),d=Math.ceil(a*l+r*o),s=Math.ceil(a*o+r*l);return t.width=d,t.height=s,n.translate(d/2,s/2),n.rotate(i),n.drawImage(e,-a/2,-r/2),createImageBitmap(n.getImageData(0,0,d,s))}async function tY(e){if(0!=e&&360!=e){if(e=e*Math.PI/180,ea.isAnimated()){g||(g=ea.frames);for(var t=[],n=0;n<g.length;++n){var{info:i,bitmap:a}=g[n],r=await tz(a,e);t[n]={info:i,bitmap:r}}ea.frames=t}else v||(v=y),y=await tz(v,e)}else if(v)y=v,v=null;else{if(!g)return;ea.frames=g,g=null}if(ea.isAnimated()){var o=tk.frame.value;y=ea.frames[o].bitmap}tN(y.width,y.height),t4=!0,tK(),tq()}function tN(e,t){tb.width=tw.width=ni.width=e,tb.height=tw.height=ni.height=t}var tX=!1;function tK(){tf.appendChild(tm),setTimeout(function(){tm.element.classList.remove("hide")},0),localStorage.getItem("tutorialShown")||(tP(),localStorage.setItem("tutorialShown","true"))}function tV(){tm.element.classList.add("hide"),tf.removeChildAfterTransition(tm),e$.hide(),tk.playGif.checked=!1}function tZ(){return tm.element.classList.contains("hide")}function tq(){var e;tJ(),e=Math.floor((y.width<y.height?y.width:y.height)*.5),e-=e%10,t8.x=t8.y=0,t$(e,e),tQ(0,0),tk.flipH.checked=tk.flipV.checked=!1,t7(),no()}function tJ(){var e=tv.element,t=e.offsetWidth,n=e.offsetHeight,i=y.width/y.height,a=tk.scaleDevicePixel.checked?1:devicePixelRatio;t6((t/n>i?n/y.height:t/y.width)*a),t5(0,0)}function tQ(e,t){tk.allowOffscreen.checked||(e=Math.max(0,Math.min(e,y.width-t8.width)),t=Math.max(0,Math.min(t,y.height-t8.height))),t8.x=e,t8.y=t,tk.xPos.value=e,tk.yPos.value=t}function t$(e,t,n){tk.allowOffscreen.checked||(e=Math.min(e,y.width-t8.x),t=Math.min(t,y.height-t8.y));var i=y.width<50||y.height<50?1:10;e=Math.max(i,e),t=Math.max(i,t),tI!=tF.FREEFORM&&((n?e>t:e<t)?t=e:e=t),t8.width=e,t8.height=t,tk.width.value=e,tk.height.value=t}var t0=0,t1=0;function t5(e,t){t0=e,t1=t;var n=tg.element;n.style.marginLeft=t0+"px",n.style.marginTop=t1+"px"}var t2=1;function t6(e){var t=tk.scaleDevicePixel.checked?1:devicePixelRatio,n=(e=Math.round(1e3*Math.max(.1,Math.min(e,8)))/1e3)/t;tg.element.style.transform="scale("+n.toFixed(3)+")",tk.zoom.value=Math.round(100*e);var i=Math.ceil(Math.max(1,1/(n*devicePixelRatio)));i!=ty.lineWidth&&(ty.lineWidth=i,t7());var a=e/t2;t5(t0*a,t1*a),t2=e,tW(J("Zoom: ")+ +(100*e).toFixed(1)+"%")}function t3(e,t){var n=tk.flipH.checked,i=tk.flipV.checked,a=1,r=1;n&&(t.translate(e.width,0),a=-1),i&&(t.translate(0,e.height),r=-1),t.scale(a,r)}var t8={x:0,y:0,width:0,height:0},t4=!1,t7=er(function(){var e,t,n,i=ty;i.globalCompositeOperation="source-over",t4?(e=[0,0,tw.width,tw.height],t4=!1):(e=x,i.clearRect(...e)),i.fillStyle="rgba(0,0,0,0.5)",i.fillRect(...e);var a=i.lineWidth,r=t8.x-a/2,o=t8.y-a/2,l=t8.width+a,d=t8.height+a;if(i.strokeStyle="#ffffff",tI==tF.CIRCLE?(i.strokeRect(r,o,l,d),t=t8.x+t8.width/2,n=t8.y+t8.height/2,i.beginPath(),i.arc(t,n,l/2-a/2,0,2*Math.PI)):(i.beginPath(),i.rect(r,o,l,d)),i.save(),i.stroke(),i.restore(),i.globalCompositeOperation="destination-out",i.fillStyle="#000000",i.fill(),tk.showGuidelines.checked){i.globalCompositeOperation="source-over",i.setLineDash([10,10]),i.strokeStyle=tk.guideColor.style.backgroundColor,i.lineWidth+=1+Math.floor(t8.width*t8.height/1e6),void 0===t&&(t=t8.x+t8.width/2,n=t8.y+t8.height/2);var s=t8.x+t8.width,c=t8.y+t8.height;i.beginPath(),eu(i,t,n,t,t8.y),eu(i,t,n,t8.x,n),eu(i,t,n,t,c),eu(i,t,n,s,n),i.stroke(),i.setLineDash([]),i.lineWidth=a}x=[t8.x-a,t8.y-a,t8.width+2*a,t8.height+2*a]}),t9=er(function(){var e=tx;e.clearRect(0,0,y.width,y.height),e.fillStyle=tk.bgColor.style.backgroundColor,e.fillRect(0,0,y.width,y.height),t3(tb,e),e.drawImage(y,0,0,y.width,y.height),e.resetTransform()}),ne=!1,nt=!1;async function nn(){if(ne){nt=!0;return}ne=!0;var e,t,n=tk.flipH.checked,i=tk.flipV.checked;if(ea.isAnimated()||n||i||!(y instanceof Image)){var r=await (na.clearRect(0,0,y.width,y.height),t3(ni,na),na.drawImage(y,0,0,y.width,y.height),na.resetTransform(),new Promise(e=>ni.toBlob(e)));e=URL.createObjectURL(r),t=!0}else e=y.src;let o=0;for(let n=0;n<a.length;++n){var l=a[n];l.addEventListener("load",function(){++o==a.length&&(ne=!1,t&&URL.revokeObjectURL(e),nt&&(nt=!1,nn()))},{once:!0}),l.src=e}}var ni=document.createElement("canvas"),na=ni.getContext("2d");function nr(){for(let i=0;i<a.length;++i){let r=a[i];var e=tR[i],t=e/t8.width,n=e/t8.height;r.style.left=-t8.x*t+"px",r.style.top=-t8.y*n+"px",r.style.width=y.width*t+"px",r.style.height=y.height*n+"px"}}function no(){t9(),tk.showPreview.checked&&(nn(),nr())}function nl(e,n){e||(e=t);let i=e.getContext("2d");e.width=t8.width,e.height=t8.height,i.fillStyle=tk.bgColor.style.backgroundColor,i.fillRect(0,0,e.width,e.height),n&&(i.filter=n),function(e,t){var n,i;let a,r;t3(e,t);let[o,l]=(n=tk.flipH.checked,i=tk.flipV.checked,a=t8.x,r=t8.y,n&&(a=y.width-t8.width-a),i&&(r=y.height-t8.height-r),[a,r]);t.drawImage(y,o,l,t8.width,t8.height,0,0,t8.width,t8.height),t.resetTransform()}(e,i)}function nd(e,t){tB.href=e,tB.download=t,tB.click()}function ns(){t.toBlob(function(e){var t=URL.createObjectURL(e);nd(t,b+"_cropped.png"),setTimeout(function(){URL.revokeObjectURL(t)},0)})}async function nc(){var e=new ea.Renderer(t8.width,t8.height,{loop:Math.floor(tk.loopCount.value)}),i=ea.frames,a=i.length?i.length-1:0,r=Math.max(0,Math.min(Math.floor(tk.startFrame.value),a)),o=Math.max(0,Math.min(Math.floor(tk.endFrame.value),a))+1,l=e8(h);$.setProgress(0),$.show();var d=tk.keepGifColors.checked,s=+tk.speedMult.value;for(let a=r;a<o;++a){let r=0;if(i.length){var c=i[a];y=c.bitmap,r=s?c.info.delay/s:0}nl(t,l);let h=n.getImageData(0,0,t8.width,t8.height);e.addFrame(h,{delay:r,keepColors:d}),$.setProgress((a+1)/o)}e.end(),$.hide(),n.filter="none";var u=new Blob([e.getUint8Array()],{type:"image/gif"}),p=URL.createObjectURL(u);nd(p,b+"_cropped.gif"),setTimeout(function(){URL.revokeObjectURL(p)},0),i.length&&(y=i[tk.frame.value].bitmap)}var nh=!1,nu=!1,np=!1,nf=!1;function nm(e){if(e$.isEyeDropperActive()){tv.element.style.cursor="default";return}var t,n=tg.element.getBoundingClientRect();if(n.x+=n.width*(t8.x/y.width),n.y+=n.height*(t8.y/y.height),n.width*=t8.width/y.width,n.height*=t8.height/y.height,(nh=ec(e.clientX,e.clientY,n))&&!nk){var i=n.x+n.width/2,a=n.y+n.height/2;(nu=!(Math.pow(e.clientX-i,2)+Math.pow(e.clientY-a,2)<Math.pow(n.width/2,2)))?(np=e.clientX<i,t=(nf=e.clientY<a)?np?"nw-resize":"ne-resize":np?"sw-resize":"se-resize"):t="move"}else t="grab";tv.element.style.cursor=t}var nv=!1,ng=!0;function nw(e){if(!tZ()&&0==e.button){if(ng=!0,e$.isEyeDropperActive()){var t=tb.getBoundingClientRect(),n={mode:"rgb"};if(ec(e.clientX,e.clientY,t)){var i=(e.clientX-t.x)/t.width*tb.width,a=(e.clientY-t.y)/t.height*tb.height,r=tx.getImageData(i,a,1,1);n.color=r.data}else n.color=[30,30,30,255];tb.dispatchEvent(new CustomEvent("eyedrop",{detail:n}))}nm(e),nh||(tv.element.style.cursor="grabbing"),nv=!0}}function ny(){ng=!1}var nb=null,nx=null;function nL(e){if(!tZ()){if(!nv){nm(e);return}if(null!=nb&&null!=nx){var t=e.clientX-nb,n=e.clientY-nx,i=tk.scaleDevicePixel.checked?1:devicePixelRatio,a=t2/i;if(e.shiftKey&&(t=a*Math.sign(t),n=a*Math.sign(n)),nh){t=Math.round(t/a),n=Math.round(n/a);var r=t8.x,o=t8.y,l=np?-1:1,d=nf?-1:1;if(nu){var s=t8.width,c=t8.height;if(tI==tF.FREEFORM)s+=t*l,c+=n*d,np&&(r+=t)<0&&(s+=r,r=0),nf&&(o+=n)<0&&(c+=o,o=0);else{var h=Math.abs(t)>Math.abs(n)?t*l:n*d,u=h*l,p=h*d;let e=r+u,i=o+p,a=e+s+h,m=i+c+h;var f=0;!tk.allowOffscreen.checked&&(np&&e<0&&(f=-e),nf&&i<0&&(f=-i),a>y.width&&(f=a-y.width-u),m>y.height&&(f=m-y.height-p)),f&&(h=f>h?0:h-f),s=c+=h,np&&(r+=h*l),nf&&(o+=h*d)}np&&s<10&&(r-=10-s),nf&&c<10&&(o-=10-c),t8.x=r,t8.y=o,t$(s,c),tQ(r,o)}else tQ(r+=t,o+=n);t7(),tk.showPreview.checked&&nr()}else t5(t0+t,t1+n)}nb=e.clientX,nx=e.clientY}}function nC(e){tZ()||0!=e.button||(nm(e),nv=!1,nb=nx=null,nh=!1)}function nE(e){if(!tZ()){var t=.1;e.deltaY>0&&(t=-t),t6(t2+t)}}var nk=!1;function nB(e){el.call(this,e),e.touches.length>=2&&(nk=!0,L=eh(e.touches[0],e.touches[1]),nh=!1)}function nF(e){if(nk){var t=eh(e.touches[0],e.touches[1]);t6(t2+(t-L)/200),L=t}}function nI(e){nk&&e.touches.length<2&&(nk=!1)}function nR(e){if(ng){if(e.code)t=e.code;else switch(e.keyCode){case 38:t="ArrowUp";break;case 40:t="ArrowDown";break;case 37:t="ArrowLeft";break;case 39:t="ArrowRight";break;default:return}var t,n=e.shiftKey?2:1;switch(t){case"ArrowUp":n=-n;case"ArrowDown":e.ctrlKey?t$(t8.width,t8.height+n,n>0):tQ(t8.x,t8.y+n);break;case"ArrowLeft":n=-n;case"ArrowRight":e.ctrlKey?t$(t8.width+n,t8.height,n>0):tQ(t8.x+n,t8.y);break;default:return}t7(),tk.showPreview.checked&&nr()}}var nM={init:function(v){var g,w,b,x,L,C,E,k,B,F,I,R,M,P,A,T,S,D,O,U,H,W,G,j;tf=v,(tm=new V.Flexbox).element.id="editorBox",tm.element.classList.add("hide"),function(){(tv=new V.Flexbox).element.id="editorInnerBox",tv.element.style.cursor="grab",tm.appendChild(tv),(tg=new V.Widget).element.id="canvasBox",tv.appendChild(tg),(tb=document.createElement("canvas")).id="imgCanvas",tg.body.appendChild(tb),tx=tb.getContext("2d"),(tw=document.createElement("canvas")).id="editorCanvas",tg.body.appendChild(tw),(ty=tw.getContext("2d")).lineWidth=1;var e,t,n=new V.Button("⛶");n.element.classList.add("innerBoxBtn"),n.element.title=J("Toggle fullscreen"),n.element.style.right="0",n.element.style.lineHeight="1.4",tv.appendChild(n);var r=new V.Button("?");r.element.classList.add("innerBoxBtn"),r.element.title=J("Show tutorial"),r.element.style.right="2.5rem",r.element.style.lineHeight="1.4",tv.appendChild(r),n.addEventListener("click",function(){document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen()}),(d=new V.Dialog(J("Tutorial"))).element.style.textAlign="center",tf.appendChild(d),e=new V.Label(J("Drag the crop selector to move or resize it.")),d.appendChild(e),(s=document.createElement("video")).style.pointerEvents="none",s.style.width="100%",s.style.marginTop="0.5rem",s.loop=!0,s.poster=new URL(tM),d.body.appendChild(s),t=new V.Label(J('Dragging anywhere outside of the crop selector will move the viewport. Use the mouse wheel or pinch the screen with two fingers to zoom in/out.\nOnce you\'re done, press the "Save image..." button to save your cropped image.\n\nYou may view this tutorial at any time by pressing the "?" button at the top right of the screen.')),d.appendChild(t),d.appendHideButton(J("OK")),r.addEventListener("click",tP),(i=new V.Flexbox).element.id="previewBox",a=[];for(let e=0;e<3;++e){var o=tR[e];let t=new V.Widget,n=t.element.style;n.width=n.height=o+"px",n.borderRadius=o/2+"px",i.appendChild(t);let r=new Image;t.element.appendChild(r),a.push(r)}tv.appendChild(i)}(),e$.init(tf),(tL=new V.Flexbox).element.id="editorMenu",tm.appendChild(tL),g=tO(J("Save image...")),w=tO(J("Save as GIF...")),b=tO(J("Fit image to viewport")),x=tO(J("Rotate...")),(L=new V.Widget).element.id="shapeBtnContainer",C=tU(J("Circle"),"circle",!0),E=tU(J("Square"),"square"),k=tU(J("Freeform"),"freeform"),L.appendChildren([C,E,k]),c=C.element,tL.appendChildren([tS(J("Save")),g,w,tS(J("Crop Area")),tk.create("width",J("Width"),"text",!0),tk.create("height",J("Height"),"text",!0),tk.create("xPos",J("X Pos"),"text",!0),tk.create("yPos",J("Y Pos"),"text",!0),tk.create("allowOffscreen",J("Allow offscreen"),"checkbox"),tS(J("Crop Shape")),L,tk.create("showGuidelines",J("Show guidelines"),"checkbox"),tk.create("guideColor",J("Guidelines color"),"color"),tS(J("Image")),tk.create("flipH",J("Flip horizontally"),"checkbox"),tk.create("flipV",J("Flip vertically"),"checkbox"),x,tk.create("frame",J("Frame"),"range"),tk.create("playGif",J("Play GIF"),"checkbox"),tk.create("bgColor",J("Background color"),"color"),tS(J("Viewport")),tk.create("zoom",J("Zoom"),"range"),tk.create("scaleDevicePixel",J("Scale to device pixel"),"checkbox"),b,tk.create("showPreview",J("Show preview"),"checkbox")]),tk.frame.value=0,tk.frame.disabled=!0,tk.showPreview.checked=!0,tk.bgColor.style.backgroundColor="rgba(255,255,255,0)",tk.guideColor.style.backgroundColor="rgb(255,255,0)",(B=new V.Button(J("Open another image"),"secondary")).element.id="returnBtn",tL.appendChild(B),(F=new V.Button(J("Hide panel"))).element.id="hideBtn",tL.appendChild(F),B.addEventListener("click",function(){tV(),n_.show()}),I=tv.element.style,F.addEventListener("click",function(){I.width&&I.height?(I.removeProperty("width"),I.removeProperty("height"),i.element.classList.remove("panelHidden"),F.text=J("Hide panel")):(I.width="100%",I.height="100%",i.element.classList.add("panelHidden"),F.text=J("Show panel"))}),tk.width.addEventListener("input",function(){tA(this,"width")}),tk.height.addEventListener("input",function(){tA(this,"height")}),tk.xPos.addEventListener("input",function(){tT(this,"x")}),tk.yPos.addEventListener("input",function(){tT(this,"y")}),tk.showGuidelines.addEventListener("change",t7),tk.flipH.addEventListener("change",no),tk.flipV.addEventListener("change",no),R=es("zoomDetents",[50,100,200,400]),(M=tk.zoom).min=10,M.max=800,M.value=t2,M.setAttribute("list",R),M.addEventListener("input",function(){t6(this.value/100)}),tk.scaleDevicePixel.addEventListener("change",function(){t6(t2)}),b.addEventListener("click",function(){tJ()}),tk.showPreview.addEventListener("change",function(e){this.checked?(i.element.style.display="flex",nn(),nr()):i.element.style.display="none"}),x.addEventListener("click",tj),tk.frame.addEventListener("input",function(){if(ea.isAnimated()){var e=this.value;y=ea.frames[e].bitmap,no(),tW(J("Frame: ")+e)}}),g.addEventListener("click",tG),w.addEventListener("click",t_),tk.playGif.addEventListener("change",function(){!(ea.frames.length<2)&&this.checked&&function e(){if(tk.playGif.checked){var t=++tk.frame.value;t==ea.frames.length&&(tk.frame.value=t=0);var n=ea.frames[t];y=n.bitmap,no(),setTimeout(e,10*n.info.delay)}}()}),tk.bgColor.addEventListener("click",function(){e$.show(this,tb)}),tk.guideColor.addEventListener("click",function(){e$.show(this,tb)}),tk.bgColor.addEventListener("colorchange",function(){t9();var e=tk.bgColor.style.backgroundColor;for(let t=0;t<a.length;++t)a[t].parentNode.style.backgroundColor=e}),tk.guideColor.addEventListener("colorchange",t7),tL.addEventListener("scroll",e$.hide,{passive:!0}),tb.addEventListener("edstatechange",function(e){e.detail?tw.style.display="none":tw.style.removeProperty("display")}),(e=new V.Floatbox).element.id="notifBox",tm.appendChild(e),e4(tf),tC(tf),(r=new V.Dialog(J("Save Image"))).element.id="saveDialog",tf.appendChild(r),P=new V.Label(J("You can save the image now, or apply some filters and check how your avatar would look on some websites.")),r.appendChild(P),r.body.appendChild(document.createElement("br")),n=(t=document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),r.body.appendChild(t),(A=new V.Widget).element.id="imgActionsContainer",r.appendChild(A),T=new V.Button("✨ "+J("Filters...")),A.appendChild(T),S=new V.Button("\uD83D\uDDBC️ "+J("Preview...")),A.appendChild(S),D=new V.Button(J("Save")),r.appendButton(D),O=new V.Button(J("Close"),"secondary"),r.appendButton(O),D.addEventListener("click",ns),O.addEventListener("click",function(){r.hide()}),T.addEventListener("click",function(){r.hide(),e7(null,t,function(){n.clearRect(0,0,t8.width,t8.height),n.drawImage(e1,0,0),r.show()})}),S.addEventListener("click",function(){r.hide(),tE(t,function(){r.show()})}),(o=new V.Dialog(J("GIF Options"))).appendChildren([tk.create("startFrame",J("Start frame"),"number"),tk.create("endFrame",J("End frame"),"number"),tk.create("loopCount",J("Loop count"),"number"),tk.create("speedMult",J("Speed multiplier"),"number"),tk.create("keepGifColors",J("Keep original colors"),"checkbox")]),(U=new V.Label(J("Filters"))).element.classList.add("menuInputBox"),o.appendChild(U),(H=new V.Button("✨ "+J("Options..."))).element.style.marginLeft="auto",U.appendChild(H),tk.startFrame.value=tk.startFrame.min=0,tk.endFrame.value=tk.endFrame.min=0,tk.loopCount.value=tk.loopCount.min=0,tk.speedMult.value=1,tk.speedMult.step=.25,tk.speedMult.min=0,tk.keepGifColors.style.paddingTop="0",W=new V.Button(J("Save")),o.appendButton(W),W.addEventListener("click",function(){o.hide(),nc()}),H.addEventListener("click",function(){o.hide(),nl(),e7(h,t,function(){o.show()})}),o.appendHideButton(J("Cancel"),"secondary"),tf.appendChild(o),(l=new V.Dialog(J("Rotate"))).element.style.textAlign="center",tf.appendChild(l),(u=document.createElement("canvas")).id="rotateCanvas",p=u.getContext("2d"),l.body.appendChild(u),m=new V.Label("0°"),l.appendChild(m),G=es("rotateDetents",[90,180,270]),(f=new V.Input("range")).element.style.width="100%",f.min=0,f.max=360,f.step=.1,f.value=0,f.element.setAttribute("list",G),f.element.setAttribute("aria-label",J("Rotation angle")),l.appendChild(f),j=new V.Button(J("Apply")),l.appendButton(j),j.addEventListener("click",function(){l.hide(),tY(f.value)}),l.appendHideButton(J("Cancel"),"secondary"),f.addEventListener("input",function(){m.text=this.value+"°",u.style.transform="rotate("+this.value+"deg)"}),tv.addEventListener("mousedown",nw),tL.addEventListener("mousedown",ny),document.addEventListener("mousemove",nL),document.addEventListener("mouseup",nC),document.addEventListener("blur",nC),tv.addEventListener("wheel",nE,{passive:!0}),"ontouchstart"in document&&(tv.addEventListener("touchstart",nB,{passive:!0}),document.addEventListener("touchmove",nF,{passive:!0}),document.addEventListener("touchend",nI,{passive:!0})),document.addEventListener("keydown",nR)},open:function(e,t){var n,i;if(tX&&(URL.revokeObjectURL(v?v.src:y.src),tX=!1),v=g=null,ea.reset()&&(tk.frame.value=0,tk.frame.disabled=!0,tk.startFrame.value=0,tk.endFrame.value=0,tk.loopCount.value=0,tk.keepGifColors.checked=!1,tk.playGif.checked=!1),$.setProgress(-1),$.show(),e instanceof File)b=e.name.slice(0,e.name.lastIndexOf(".")),"image/gif"==e.type&&ea.load(e,tk),e=URL.createObjectURL(e),tX=!0;else{if(""==e)return;if(y&&e==y.src){$.hide(),tK(),tq(),t();return}b=e.slice(e.lastIndexOf("/")+1,e.lastIndexOf("."))}y instanceof Image||(y=new Image),y.addEventListener("load",n=function(){$.setProgress(1),$.hide(),tN(y.width,y.height),t4=!0,f.value=0,m.text="0°",u.style.transform="",w=!0,tK(),tq(),t(),y.removeEventListener("load",n),y.removeEventListener("error",i)}),y.addEventListener("error",i=function(){$.hide(),ee.show(J("Failed to load image.")),y.removeEventListener("load",n),y.removeEventListener("error",i)}),y.src=e},show:tK,hide:tV},nP={};function nA(){C.hide()}nP=P("l35ZM").getBundleURL("6gEBg")+"banner.2c50771c.svg";var nT={init:function(e){(C=new V.Dialog(J("About"))).element.style.textAlign="center",e.appendChild(C);var t=document.createElement("img");t.src=new URL(nP),t.alt="Banner",t.width=740,t.height=128,t.style.width="auto",t.style.height="3rem",t.style.marginBottom="0.5rem",t.draggable=!0,C.body.appendChild(t),C.body.appendChild(document.createElement("br"));var n=new V.Label(J("Simple and accurate avatar cropping tool.\n"));C.appendChild(n);var i=new V.Label(J("Source code: "));C.appendChild(i);var a=document.createElement("a");a.href="https://github.com/LeadRDRK/AvatarCropper",a.innerText=a.href+"\n",a.target="_blank",a.draggable=!1,C.body.appendChild(a),C.body.appendChild(document.createElement("hr"));var r=document.createElement("b");r.innerText=J("Translators\n"),C.body.appendChild(r);var o=Q.getLanguages();for(let e in o){var l=o[e],d=new V.Label(l.name+" - "+l.author+"\n");C.appendChild(d)}var s=new V.Button(J("OK"));C.appendButton(s),s.addEventListener("click",nA),t.addEventListener("dragstart",function(e){e.dataTransfer.setData("text/pain","https://leadrdrk.com/static/generic.png")}),t.addEventListener("dragend",function(e){ee.show("it's him! (drawn by @ReikoRobo)"),nA()})},show:function(){C.show()},hide:nA};function nS(){E.hide()}var nD={init:function(e){E=new V.Dialog(J("Privacy")),e.appendChild(E),E.body.innerText=J("This app runs entirely in your browser! No image or data is ever uploaded to any external server.");var t=new V.Button(J("OK"));E.appendButton(t),t.addEventListener("click",nS)},show:function(){E.show()},hide:nS};function nO(){B.element.classList.add("hide"),F.hide(),nW.shown=!1,k.removeChildAfterTransition(B,function(){k.contains(F)&&k.removeChild(F)})}var nU=document.createElement("input");function nH(){nU.value=null,nU.click()}nU.type="file",nU.accept="image/*",nU.addEventListener("change",function(e){var t=this.files;for(let e=0;e<t.length;++e){let n=t[e];if(n.type.startsWith("image/")){nM.open(n,nO);return}}ee.show(J("Invalid image file."))});var nW={shown:!1,init:function(e,t){k=e,nT.init(k),nD.init(k),(B=new V.Flexbox).element.id="welcomeScreen",B.justifyContent="center",B.alignItems="center";var n,i,a,r=new V.Flexbox("column");r.element.id="titleBox",r.gap="0.25rem";var o=document.createElement("img");o.src=new URL(nP),o.width=740,o.height=128,o.id="title",o.alt="Banner",o.draggable=!1,o.onload=t,r.element.appendChild(o);var l=new V.Label("v2.1.3 - ");l.element.id="versionLabel";var d=new V.Button(J("About"),"link");l.appendChild(d),l.element.appendChild(document.createTextNode(" | "));var s=new V.Button(J("Privacy"),"link");l.appendChild(s),l.element.appendChild(document.createTextNode(" | "));var c=document.createElement("a");c.innerText=J("Changelog"),c.href="https://github.com/LeadRDRK/AvatarCropper/releases",c.draggable=!1,c.target="_blank",l.element.appendChild(c),r.appendChild(l);var h=new V.Selector;h.element.id="langSelector";var u=Q.getLanguages();for(let e in u)h.addOption(u[e].name,e);h.value=localStorage.getItem("lang"),r.appendChild(h);var p=new V.Flexbox("column");p.element.id="openButtonsBox",p.gap="0.5rem";var f=new V.Button(J("Open File..."));p.appendChild(f);var m=new V.Button(J("Paste Image..."),"secondary");p.appendChild(m);var v=new V.Label(J("You can also drag and drop an image here."));v.element.style.textAlign="center",v.element.style.fontStyle="italic",p.appendChild(v),B.appendChild(r),B.appendChild(p),f.addEventListener("click",nH),F=new V.Dialog(J("Paste Image")),n=J("Paste your image into the input box."),(i=new V.Label(n)).element.style.marginBottom="0.5rem",F.appendChild(i),(a=new V.Input("text")).element.id="urlInput",a.element.setAttribute("aria-label",n),F.appendChild(a),F.appendHideButton(J("Cancel")),a.addEventListener("paste",function(e){var t=e.clipboardData||e.originalEvent.clipboardData;if(t){var n=t.items;for(let e=0;e<n.length;++e){let t=n[e];if("file"==t.kind){let e=t.getAsFile();if(e.type.startsWith("image/")){nM.open(e,nO);break}}}}}),a.addEventListener("input",function(){a.value=""}),k.appendChild(F),m.addEventListener("click",F.show.bind(F)),d.addEventListener("click",nT.show.bind(nT)),s.addEventListener("click",nD.show.bind(nD)),h.addEventListener("change",function(){localStorage.setItem("lang",this.value),nK()}),nW.shown=!0},show:function(){setTimeout(function(){B.element.classList.remove("hide")},0),k.appendChild(B),k.appendChild(F),nW.shown=!0},hide:nO},n_=nW;function nG(e,t){var n=new CustomEvent("imagedrop",{detail:e});t.dispatchEvent(n)}function nj(e,t){return!!e.type.startsWith("image/")&&(nG(e,t),!0)}var nz=["Hey, you should drop your file into the window.","Just drop it...","I'm getting rather impatient.","What are you doing!?","Drop it now!","Stop teasing me!","I beg you!","Please, just give me your file!!!"];function nY(e,t){this.element=t;var n=new V.Flexbox;n.element.id="dndOverlay";var i=0,a=0;t.addEventListener("dragenter",function(){if(0==a&&(e.appendChild(n),++i>=10)){var t=nz[Math.min(i-10,nz.length-1)];ee.show(t)}++a}),t.addEventListener("dragleave",function(){0==--a&&e.removeChild(n)}),t.addEventListener("drop",function(r){r.preventDefault(),i>=10+nz.length-1&&ee.show("Thank you."),i=0,e.removeChild(n),a=0;var o=r.dataTransfer.getData("text/pain");if(o){nG(o,t);return}if(r.dataTransfer.items){for(let e of r.dataTransfer.items)if("file"==e.kind&&nj(e.getAsFile(),t))return}else for(let e of r.dataTransfer.files)if(nj(e,t))return;ee.show(J("Invalid image file."))}),t.addEventListener("dragover",function(e){e.preventDefault()})}nY.prototype.addListener=function(e){this.element.addEventListener("imagedrop",e)};var nN={};async function nX(){"serviceWorker"in navigator&&navigator.serviceWorker.register(nN),document.body.innerHTML="";var e=new V.Container;e.element.style.backgroundColor="#1e1e1e",e.createShadow(),ee.init(e);try{await Q.init();var t=function(){var e=localStorage.getItem("lang");if(null==e){var t=Q.getLanguages(),n=navigator.language.toLowerCase();for(let i in t)if(0==i.indexOf(n)){e=i;break}null==e&&(e="en-us"),localStorage.setItem("lang",e)}return e}();try{await Q.loadLanguage(t)}catch(e){ee.show("Failed to load translations for "+t)}}catch(e){ee.show("Failed to initialize i18n.")}nM.init(e),$.init(e),$.setProgress(-1),$.show(),n_.init(e,function(){n_.show(),$.hide()}),new nY(e,document.body).addListener(e=>{nM.open(e.detail,function(){n_.shown&&n_.hide()})}),"ontouchmove"in document&&(document.addEventListener("touchmove",el,{passive:!0}),document.addEventListener("touchend",el,{passive:!0})),window.scrollTo(0,1)}nN=P("l35ZM").getBundleURL("6gEBg")+"sw.js",nX();var nK=nX;
//# sourceMappingURL=index.1836cb60.js.map
